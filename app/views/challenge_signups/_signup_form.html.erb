<h2><%= ts("Sign Up For %{title}", :title => @collection.title) %></h2>

<!-- descriptions-->
<!-- /descriptions-->
<!--subnavigation, sorting and actions-->
<!--/subnav-->

<!--main content-->
<%= form_for([@collection, @challenge_signup], :url => (edit_record ? collection_signup_path(@collection) : collection_signups_path(@collection))) do |signup_form| %>
  <%= error_messages_for @challenge_signup %>

  <%= render "signup_form_general_information", :form => signup_form %>

  <% # requests and offers section %>
  <% @challenge.class::PROMPT_TYPES.each do |prompt_type| %>
  <fieldset>
    <legend><%= prompt_type.capitalize %></legend>
    <h3>
      <%= prompt_type.capitalize %> (<%= @challenge.allowed_range_string(prompt_type) %>)      
    </h3>
    <%=raw sanitize_field(@challenge, "signup_instructions_#{prompt_type}".to_sym) %>
    
    <% @challenge_signup.send("#{prompt_type}").each_with_index do |prompt, index| %>
      <%= signup_form.fields_for prompt_type.to_sym, prompt do |prompt_form| %>
        <%= render "prompts/prompt_form", :form => prompt_form, :index => index, :edit_record => false, 
                        :required => (index < @challenge.required(prompt_type)) %>
      <% end %>
    <% end %>
    
    <% if @challenge.allowed(prompt_type) > @challenge.required(prompt_type) %>
      <p class="navigation showme" style="display: none;">
        <%= link_to_add_section(
             ts("Add another %{type}? (Up to %{allowed} allowed.)", :type => prompt_type.singularize, :allowed => @challenge.allowed(prompt_type)), 
             signup_form, prompt_type.to_sym, "prompts/prompt_form", {:required => false, :edit_record => false}) 
        %>
      </p>
    <% end %>

  </fieldset>
  <% end # requests & offers section %>

  <fieldset>
    <legend><%= 'Submit' %></legend> 
    <p class="submit">
      <%= signup_form.submit ts('Submit') %>
    </p>
  </fieldset>

<% end %>

<!--/content-->

<!--subnav-->
<ul class="navigation" role="navigation">
  <li><%= link_to 'Back', @collection %></li>
</ul>
<!--/subnav-->
