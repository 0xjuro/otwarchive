<%= taggable_list(params[:tag_id], "works") if params[:tag_id] -%>

<%- if @most_recent_works -%><h1><%=h t('recently_updated', :default => "Works updated in the last month") %></h1><%- end -%>
<h2><%= search_header @works, @query %></h2>

<%-if !@most_recent_works and @works.total_entries > ArchiveConfig.SEARCH_RESULTS_MAX %>
  <p><%= t('search_too_broad', :default => "Your search was so broad it would have returned more than {{search_max}} works. You can either browse through the ones that we found first, or narrow your search down by adding some more keywords to your search, like character names or tags.", :search_max => ArchiveConfig.SEARCH_RESULTS_MAX) %></p>
<%- end -%>

<% paginated_section @works, {:previous_label => '&laquo; Previous', :next_label => 'Next &raquo;'} do %>

<% if @user && @user == current_user %>
<div class="navigation" style="text-align: left;">
  <span class="navitem" id="edit_multiple">
    <%= link_to t('edit_multiple_link', :default => 'Edit Multiple Works'), 
                show_multiple_user_works_path(@user) -%>
  </span>
</div>
<% end %>

  <div class="navigation">
    <span class="navlabel"><%= t('sort_by', :default => 'Sort By') -%></span> 
    <%- unless @query.blank? -%>
    <span class="navitem"><%= sort_link t('sort.relevance', :default => 'Relevance') %></span>
    <%- end -%>
    <span class="navitem"><%= sort_link t('sort.author', :default => 'Author'), :author -%></span>
    <span class="navitem"><%= sort_link t('sort.title', :default => 'Title'), :title -%></span>
    <span class="navitem"><%= sort_link t('sort.date', :default => 'Date'), :date -%></span>
    <span class="navitem"><%= sort_link t('sort.word_count', :default => 'Word Count'), :word_count -%></span>
  </div>

  <%= render :partial => 'filters' %>

  <ul class="work-list">
    <%- for work in @works -%>
      <%= render :partial => 'work_blurb', :locals => {:work => work} %>
    <%- end -%>
  </ul>

<% end %>



