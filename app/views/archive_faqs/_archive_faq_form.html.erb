<noscript>
  <%= form_tag({}, {:method => :get}) do %>
    <fieldset>
      <legend><%= ts("Add Questions") %></legend>
      <h3 class="landmark heading"><%= ts("Add Questions") %></h3>
      <p class="notes">
        <%= ts("Since you don't have JavaScript turned on, please tell us how many questions you want this category to have. (This must be greater than the current number of questions, which is %{num}.) ", :num => @archive_faq.questions.count) %>
      </p>
      <p>
        <%= label_tag "num_questions", ts("Questions:") %>
        <%= text_field_tag "num_questions", params["num_questions"], :class => "number" %>
      </p>
      <p class="submit"><%= submit_tag ts('Update Form') %></p>
    </fieldset>
  <% end %>
</noscript>

<% # TODO: STOP ERRORS IF ALL QUESTION FIELDS AREN'T FILLED IN %>
<%= form_for(@archive_faq, :html => {:class => "create faq"}) do |form| %>
  <%= error_messages_for @archive_faq %>
  <p class="required notice"><%= ts('* Required information') %></p>
  <fieldset>
    <legend><%= ts("Set Preferences") %></legend>
    <h3 class="landmark heading"><%= ts("Set Preferences") %></h3>
    <dl>
      <dt class="required">
        <%= form.label :title, ts("Category name") + "*" %>
      </dt>
      <dd class="required">
        <%= form.text_field :title %>
        <%= live_validation_for_field(field_id(form, "title").to_sym, :failureMessage => ts("Please enter a category name.")) %>
      </dd>
      <dt class="required">
        <%= form.label :language_id, ts("Language") + "*" %>
      </dt>
      <dd class="required">
        <select id="archive_faq_language_id" name="archive_faq[language_id]">
          <%= options_from_collection_for_select(Language.default_order, :id, :name, @archive_faq.language_id || Language.default.id) %>
        </select>
      </dd>
      <dt>
        <%= form.label :translated_faq_id, ts("Is this a translation of another FAQ?") %>
      </dt>
      <dd>
        <%= form.collection_select(:translated_faq_id, @translatable_faqs, :id, :title, {:prompt => true}) %>
      </dd>
      <dt>
        <%= form.check_box :notify_translations %>
      </dt>
      <dd>
        <%= form.label :notify_translations, ts("Notify Translation Committee of changes you made in this FAQ category?") %>
      </dd>
    </dl>
  </fieldset>
  
  <fieldset>
    <legend><%= ts("Questions") %></legend>
    <h3 class="landmark heading"><%= ts("Questions") %></h3>
  
    <% form.object.questions.each_with_index do |question, index| %>
      <%= form.fields_for :questions, question do |question_form| %>
        <%= render 'question_answer_fields', :form => question_form, :index => index %>
      <% end %>
    <% end %>
    
    <p class="actions" role="button">
      <%= link_to_add_section("Add Question", form, :questions, "question_answer_fields", :required => false) %>
    </p>
    
  </fieldset>
  <fieldset>
    <legend><%= ts("Submit") %></legend>
    <h3 class="landmark heading"><%= ts("Submit") %></h3>
    <p class="submit actions">
      <%= submit_tag ts('Post'), :name => 'post_button' %>
    </p>
  </fieldset>
<% end %>