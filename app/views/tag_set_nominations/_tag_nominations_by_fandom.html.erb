<% @tag_set_nomination.fandom_nominations.each_with_index do |nom, index| %>
  <%= f.fields_for :fandom_nominations, nom do |nom_form| %>
    <fieldset class="tagset <%= cycle :odd, :even %>">
      <legend><%= ts("Fandom %{index}", :index => index+1) %></legend>
      <dl>
        <dt><%= nom_form.label :tagname, ts("Fandom %{index}", :index => index+1) %></dt>
        <dd>
          <% if nom.approved || nom.rejected %>
            <%= nom.tagname %>  <%= nomination_status(nom) %>
          <% else %>
            <%= nom_form.text_field :tagname, autocomplete_options("fandom", :autocomplete_token_limit => 1, :class => "autocomplete") %>
          <% end %>     
        </dd>

        <dt>
          <%= nom_form.label :parent_tagname, ts("Type?") %>
          <% unless @past_first %>
            <%= link_to_help 'tagset-type-for-fandom' %>
            <% @past_first = true %>
          <% end %>           
        </dt>
        <dd><%= nom_form.select :parent_tagname, options_for_select(Media.canonical.by_name.collect {|m| [m.name, m.name]}), :include_blank => true %></dd>

        <% # if fandoms are being nominated then any character/relationship noms go under fandom %>
        <% %w(character relationship).each do |tag_type| %>
          <%= nom_form.fields_for "#{tag_type}_nominations".to_sym do |nom_form2| %>
            <dt><%= nom_form2.label :tagname, ts("#{tag_type.classify}") %>
            <dd>
              <% if nom_form2.object.approved  || nom_form2.object.rejected %>
                <%= nom_form2.object.tagname %> <%= nomination_status(nom_form2.object) %>
              <% else %>
                <%= nom_form2.text_field :tagname, 
                          autocomplete_options("#{tag_type}_in_fandom", :autocomplete_token_limit => 1, 
                          :autocomplete_live_params => "fandom=tag_set_nomination_fandom_nominations_attributes_#{index}_tagname") %>
              <% end %>
            </dd>
          <% end %>
        <% end %>
      </dl>
    </fieldset>
  <% end %>
<% end %>
