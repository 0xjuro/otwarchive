<div class="tagset"><!--this is probably what we should do for each feature, reckon?-->
	<h2><%= ts("Review Nominations") %></h2>

<h3 class="landmark">Navigation</h3>
  <ul class="navigation" role="navigation">
    <% @tag_types.each do |type| %>
  	  <li>
  	    <% if (@tag_type == type) %>
  	      <span class="current"><%= ts("#{type.classify.pluralize}") %></span>
  	    <% else %>
  	      <%= link_to ts("#{type.classify.pluralize}"), url_for(:tag_type => type) %>
  	    <% end %>
  	  </li>
  	<% end %>
  	<% if @tag_set.user_is_owner?(current_user) %>
      <li><%= link_to ts("Clear Nominations"), destroy_multiple_tag_set_nominations_path(@tag_set),
        :confirm => ts('Are you certain you want to clear nominations for this tag set? (This will NOT affect tags you have approved, but it will clear the history of rejected tags.)'),
        :method => :post %></li>
    <% end %>
  </ul>


<p class="notes">
  You can either approve or reject nominations, or leave them unmarked if you want to review them later on. Once a nomination
  is either approved or rejected, it will no longer appear on this page. (You can always manually add a tag yourself if you 
  accidentally reject one that you meant to approve.)
</p>
<p class="notes">
  Please note that we may occasionally clear out old nominations after several months to avoid database clutter, so please don't 
  leave nominations turned on unless you are actively reviewing nominations on a regular basis.
</p>

<%= form_for :tag_set_nominations, :url => update_multiple_tag_set_nominations_path(@tag_set), :html => { :method => :put } do |form| %>
  <h3>Nominated <%= @tag_type.classify.pluralize %><%= hidden_field_tag "tag_type", @tag_type %></h3>
  
  <% %w(canonical existing nonexistent).each do |section| %>
    <% noms = @nominations[section] %>
    <% unless noms.empty? %>
      <fieldset>
        <legend><%=ts("#{section.capitalize}")%></legend>
	      <h4><%=ts("#{section.capitalize}")%></h4>
        <p class="notes">
          <% if section == "canonical" %>          
            These tags are canonical and wrangled. However, you may have more and less specific versions of the same tag
            nominated (eg, "Sam" and "Sam Winchester" where "Sam" is a meta tag covering all characters named Sam Whatever). 
          <% elsif section == "existing" %>
            The following nominated tags exist but are not canonical. They may have an official synonym, in which case
            you can approve the synonym instead (or in addition if you really want, but that is not recommended).
          <% else %>
            These nominated tags don't exist on the archive at all. Please check them
            closely before approving them for addition!
          <% end %>
        </p>
        <ul class="navigation actions">
      		<li>Approve</li>
      		<li><a href="#" class="check_all" checkbox_name_filter="approve">All</a></li>
      		<li><a href="#" class="check_none" checkbox_name_filter="approve">None</a></li>
	        <li>Reject</li>
      		<li><a href="#" class="check_all" checkbox_name_filter="reject">All</a></li>
      	 	<li><a href="#" class="check_none" checkbox_name_filter="reject">None</a></li>
      	 	<% if section == "existing" %>
            <li>Synonym</li>
        	  <li><a href="#" class="check_all" checkbox_name_filter="synonym">All</a></li>
        	  <li><a href="#" class="check_none" checkbox_name_filter="synonym">None</a></li>
      	 	<% end %>
        </ul>
        <ul class="options<%= noms.count > (ArchiveConfig.OPTIONS_TO_SHOW * 3) ? ' many' : ''%>">
          <% noms.names_with_count.each do |nom| %>
            <li class="<%= cycle("odd", "even") %>">
              <%= nom.tagname %> (<%= nom.count %>)
              <%= label_tag "approve_#{nom.tagname}", :class => "action" do %>
                <%= ts("Approve") %>
                <%= check_box_tag "approve_#{nom.tagname}", 1, params["approve_#{nom.tagname}"] %>            
              <% end %>
              <%= label_tag "reject_#{nom.tagname}", :class => "action"  do %>
                <%= ts("Reject") %>
                <%= check_box_tag "reject_#{nom.tagname}", 1, params["reject_#{nom.tagname}"] %>            
              <% end %>
              <% if section == "existing" && nom.synonym %>
                <%= label_tag "approve_#{nom.synonym}", :class => "action" do %>
                  <%= nom.synonym %>
                  <%= check_box_tag "synonym_#{nom.synonym}", 1, params["synonym_#{nom.synonym}"] %>            
                <% end %>
              <% end %>
            </li>        
          <% end %>
        </ul>
      </fieldset>
    <% end %>
  <% end %>

  <fieldset>
    <p class="submit"><%= submit_tag "Submit" %></p>      
  </fieldset>    

<% end %>
</div>