<h2>Your Claims<% if @collection %> In <%= link_to(@collection.title, @collection) %><% end %></h2>
<!--FRONT END: TABLEWATCH!!-->
<ul class="index">

  <% @challenge_claims.each do |claim| %>
    <% @request = claim.request_signup %>
    <% @challenge = claim.collection.challenge %>
    <li class="collection claim picture blurb">
      <div class="header module">
<!--claim title-->      
      <h4 title="title">  
      <% if claim.creation %>
          <% if claim.creation.is_a?(Work) %>
            <%= link_to claim.creation.title, work_path(claim.creation) -%>
          <% end %>
        </h4>
<!--collection title and recipient forline-->
      <h5>In <%= link_to claim.collection.title, collection_url(claim.collection) -%> <% end %>
      <% prompt_id = claim.request_prompt_id %>
      <% prompt = Prompt.find_by_id(prompt_id) %>
      
      <span class="byline">For <% if @request && !prompt.anonymous? %>
      <%= link_to(@request.pseud.byline, collection_claim_path(claim.collection, claim)) %>
      <% elsif prompt.anonymous? %>
      <%= link_to(ts("Anonymous"), collection_claim_path(claim.collection, claim)) %>
      <% end %>
      </span>
      </h5>

<!--due date-->
      <% if @challenge.respond_to?("assignments_due_at") %>
        <p class="datetime">Due at <%= time_in_zone(@challenge.assignments_due_at, (@challenge.time_zone || Time.zone.name)) -%></p>
      <% end %>
    </div>
      
<!--prompt tags, BACK END please class uls "{type} tags"-->
      <h6 class="landmark">Tags</h6>
          <% TagSet::TAG_TYPES.each do |type| %>
            <% eval("@show_request_#{type}_tags = (@challenge.request_restriction.#{type}_num_allowed > 0) && !params[:hide_tags]") %>
          <% end %>
          <% TagSet::TAG_TYPES.each do |type| %>
            <% if eval("@show_request_#{type}_tags") %>
                <% if prompt && prompt.tag_set && !prompt.tag_set.with_type(type).empty? %>
                  <%= content_tag(:ul, tag_link_list(prompt.tag_set.with_type(type))) %>
                <% end %>
            <% end %>  
          <% end %>

<!--claim status-->
      <p class="status notice">
          <% if !claim.fulfilled? %>
            This work has not yet been approved by the challenge moderators.
        <% else %>
          Not yet posted.
        <% end %>
      </p>
      
<!--actions-->
          <ul class="actions" role="menu">
            <li><%= link_to ts("Post To Fulfill"), new_collection_work_path(claim.collection, :claim_id => claim.id) %></li>
            <% unless claim.fulfilled? %>
              <li><%= link_to ts("Delete"), collection_claim_path(claim.collection, claim), :confirm => ts('Are you sure you want to delete this claim?'), :method => :delete %></li>
            <% end %>
          </ul>
    </li>

  <% end %>
</ul>
