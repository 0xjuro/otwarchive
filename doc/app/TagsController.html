<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: TagsController</title>

	<link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="./app/controllers/tags_controller_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="app/controllers/tags_controller.rb">app/controllers/tags_controller.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link"><a href="ApplicationController.html">ApplicationController</a></p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-i-create">#create</a></li>
					
					<li><a href="#method-i-edit">#edit</a></li>
					
					<li><a href="#method-i-feed">#feed</a></li>
					
					<li><a href="#method-i-index">#index</a></li>
					
					<li><a href="#method-i-mass_update">#mass_update</a></li>
					
					<li><a href="#method-i-new">#new</a></li>
					
					<li><a href="#method-i-remove_association">#remove_association</a></li>
					
					<li><a href="#method-i-search">#search</a></li>
					
					<li><a href="#method-i-show">#show</a></li>
					
					<li><a href="#method-i-show_hidden">#show_hidden</a></li>
					
					<li><a href="#method-i-update">#update</a></li>
					
					<li><a href="#method-i-wrangle">#wrangle</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="./doc/README_FOR_APP.html">README_FOR_APP</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./Static.html">Static</a></li>
				
					<li><a href="./Static/BaseController.html">Static::BaseController</a></li>
				
					<li><a href="./Static/CollectionsController.html">Static::CollectionsController</a></li>
				
					<li><a href="./Static/FandomsController.html">Static::FandomsController</a></li>
				
					<li><a href="./Static/MediaController.html">Static::MediaController</a></li>
				
					<li><a href="./Static/RestrictedWorksController.html">Static::RestrictedWorksController</a></li>
				
					<li><a href="./Static/WorksController.html">Static::WorksController</a></li>
				
					<li><a href="./Admin.html">Admin</a></li>
				
					<li><a href="./Admin/AdminInvitationsController.html">Admin::AdminInvitationsController</a></li>
				
					<li><a href="./Admin/AdminUsersController.html">Admin::AdminUsersController</a></li>
				
					<li><a href="./Admin/SettingsController.html">Admin::SettingsController</a></li>
				
					<li><a href="./Admin/SkinsController.html">Admin::SkinsController</a></li>
				
					<li><a href="./Admin/UserCreationsController.html">Admin::UserCreationsController</a></li>
				
					<li><a href="./ActionController.html">ActionController</a></li>
				
					<li><a href="./ActionController/Routing.html">ActionController::Routing</a></li>
				
					<li><a href="./ActionController/Routing/RouteSet.html">ActionController::Routing::RouteSet</a></li>
				
					<li><a href="./Challenge.html">Challenge</a></li>
				
					<li><a href="./Challenge/GiftExchangeController.html">Challenge::GiftExchangeController</a></li>
				
					<li><a href="./Challenge/PromptMemeController.html">Challenge::PromptMemeController</a></li>
				
					<li><a href="./ActiveRecord.html">ActiveRecord</a></li>
				
					<li><a href="./AutocompleteSource.html">AutocompleteSource</a></li>
				
					<li><a href="./AutocompleteSource/ClassMethods.html">AutocompleteSource::ClassMethods</a></li>
				
					<li><a href="./ChallengeCore.html">ChallengeCore</a></li>
				
					<li><a href="./ChallengeCore/ClassMethods.html">ChallengeCore::ClassMethods</a></li>
				
					<li><a href="./StoryParser.html">StoryParser</a></li>
				
					<li><a href="./StoryParser/Error.html">StoryParser::Error</a></li>
				
					<li><a href="./XhtmlSplitter.html">XhtmlSplitter</a></li>
				
					<li><a href="./XhtmlSplitter/Error.html">XhtmlSplitter::Error</a></li>
				
					<li><a href="./AbuseReport.html">AbuseReport</a></li>
				
					<li><a href="./AbuseReportsController.html">AbuseReportsController</a></li>
				
					<li><a href="./AdminMailer.html">AdminMailer</a></li>
				
					<li><a href="./AdminPost.html">AdminPost</a></li>
				
					<li><a href="./AdminPostTag.html">AdminPostTag</a></li>
				
					<li><a href="./AdminPostTagging.html">AdminPostTagging</a></li>
				
					<li><a href="./AdminPostsController.html">AdminPostsController</a></li>
				
					<li><a href="./AdminSession.html">AdminSession</a></li>
				
					<li><a href="./AdminSessionsController.html">AdminSessionsController</a></li>
				
					<li><a href="./AdminSetting.html">AdminSetting</a></li>
				
					<li><a href="./AdminsController.html">AdminsController</a></li>
				
					<li><a href="./AdvancedSearchHelper.html">AdvancedSearchHelper</a></li>
				
					<li><a href="./AlphabetHelper.html">AlphabetHelper</a></li>
				
					<li><a href="./ApplicationController.html">ApplicationController</a></li>
				
					<li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
				
					<li><a href="./ArchiveFaq.html">ArchiveFaq</a></li>
				
					<li><a href="./ArchiveFaqsController.html">ArchiveFaqsController</a></li>
				
					<li><a href="./AuthlogicHelpersForMailers.html">AuthlogicHelpersForMailers</a></li>
				
					<li><a href="./AutocompleteController.html">AutocompleteController</a></li>
				
					<li><a href="./Banned.html">Banned</a></li>
				
					<li><a href="./Bookmark.html">Bookmark</a></li>
				
					<li><a href="./BookmarksController.html">BookmarksController</a></li>
				
					<li><a href="./BookmarksHelper.html">BookmarksHelper</a></li>
				
					<li><a href="./CacheHelper.html">CacheHelper</a></li>
				
					<li><a href="./CastNomination.html">CastNomination</a></li>
				
					<li><a href="./Category.html">Category</a></li>
				
					<li><a href="./ChallengeAssignment.html">ChallengeAssignment</a></li>
				
					<li><a href="./ChallengeAssignmentsController.html">ChallengeAssignmentsController</a></li>
				
					<li><a href="./ChallengeClaim.html">ChallengeClaim</a></li>
				
					<li><a href="./ChallengeClaimsController.html">ChallengeClaimsController</a></li>
				
					<li><a href="./ChallengeHelper.html">ChallengeHelper</a></li>
				
					<li><a href="./ChallengeRequestsController.html">ChallengeRequestsController</a></li>
				
					<li><a href="./ChallengeSignup.html">ChallengeSignup</a></li>
				
					<li><a href="./ChallengeSignupObserver.html">ChallengeSignupObserver</a></li>
				
					<li><a href="./ChallengeSignupSweeper.html">ChallengeSignupSweeper</a></li>
				
					<li><a href="./ChallengeSignupsController.html">ChallengeSignupsController</a></li>
				
					<li><a href="./ChallengeSweeper.html">ChallengeSweeper</a></li>
				
					<li><a href="./ChallengesController.html">ChallengesController</a></li>
				
					<li><a href="./Chapter.html">Chapter</a></li>
				
					<li><a href="./ChapterSweeper.html">ChapterSweeper</a></li>
				
					<li><a href="./ChaptersController.html">ChaptersController</a></li>
				
					<li><a href="./ChaptersHelper.html">ChaptersHelper</a></li>
				
					<li><a href="./Character.html">Character</a></li>
				
					<li><a href="./CharacterNomination.html">CharacterNomination</a></li>
				
					<li><a href="./Collectible.html">Collectible</a></li>
				
					<li><a href="./Collection.html">Collection</a></li>
				
					<li><a href="./CollectionItem.html">CollectionItem</a></li>
				
					<li><a href="./CollectionItemsController.html">CollectionItemsController</a></li>
				
					<li><a href="./CollectionObserver.html">CollectionObserver</a></li>
				
					<li><a href="./CollectionParticipant.html">CollectionParticipant</a></li>
				
					<li><a href="./CollectionParticipantsController.html">CollectionParticipantsController</a></li>
				
					<li><a href="./CollectionPreference.html">CollectionPreference</a></li>
				
					<li><a href="./CollectionProfile.html">CollectionProfile</a></li>
				
					<li><a href="./CollectionProfileController.html">CollectionProfileController</a></li>
				
					<li><a href="./CollectionSweeper.html">CollectionSweeper</a></li>
				
					<li><a href="./CollectionsController.html">CollectionsController</a></li>
				
					<li><a href="./CollectionsHelper.html">CollectionsHelper</a></li>
				
					<li><a href="./Comment.html">Comment</a></li>
				
					<li><a href="./CommentMailer.html">CommentMailer</a></li>
				
					<li><a href="./CommentObserver.html">CommentObserver</a></li>
				
					<li><a href="./CommentSweeper.html">CommentSweeper</a></li>
				
					<li><a href="./CommentsController.html">CommentsController</a></li>
				
					<li><a href="./CommentsHelper.html">CommentsHelper</a></li>
				
					<li><a href="./CommonTagging.html">CommonTagging</a></li>
				
					<li><a href="./CreationObserver.html">CreationObserver</a></li>
				
					<li><a href="./Creatorship.html">Creatorship</a></li>
				
					<li><a href="./CssCleaner.html">CssCleaner</a></li>
				
					<li><a href="./DateHelper.html">DateHelper</a></li>
				
					<li><a href="./DevmodeController.html">DevmodeController</a></li>
				
					<li><a href="./DownloadsController.html">DownloadsController</a></li>
				
					<li><a href="./EmailVeracityValidator.html">EmailVeracityValidator</a></li>
				
					<li><a href="./ErrorsController.html">ErrorsController</a></li>
				
					<li><a href="./ExternalAuthor.html">ExternalAuthor</a></li>
				
					<li><a href="./ExternalAuthorName.html">ExternalAuthorName</a></li>
				
					<li><a href="./ExternalAuthorsController.html">ExternalAuthorsController</a></li>
				
					<li><a href="./ExternalAuthorsHelper.html">ExternalAuthorsHelper</a></li>
				
					<li><a href="./ExternalCreatorship.html">ExternalCreatorship</a></li>
				
					<li><a href="./ExternalWork.html">ExternalWork</a></li>
				
					<li><a href="./ExternalWorksController.html">ExternalWorksController</a></li>
				
					<li><a href="./Fandom.html">Fandom</a></li>
				
					<li><a href="./FandomNomination.html">FandomNomination</a></li>
				
					<li><a href="./FandomsController.html">FandomsController</a></li>
				
					<li><a href="./FeedSweeper.html">FeedSweeper</a></li>
				
					<li><a href="./Feedback.html">Feedback</a></li>
				
					<li><a href="./FeedbacksController.html">FeedbacksController</a></li>
				
					<li><a href="./FilterCount.html">FilterCount</a></li>
				
					<li><a href="./FilterTagging.html">FilterTagging</a></li>
				
					<li><a href="./FindRandom.html">FindRandom</a></li>
				
					<li><a href="./Freeform.html">Freeform</a></li>
				
					<li><a href="./FreeformNomination.html">FreeformNomination</a></li>
				
					<li><a href="./Gift.html">Gift</a></li>
				
					<li><a href="./GiftExchange.html">GiftExchange</a></li>
				
					<li><a href="./GiftsController.html">GiftsController</a></li>
				
					<li><a href="./HitCounter.html">HitCounter</a></li>
				
					<li><a href="./HomeController.html">HomeController</a></li>
				
					<li><a href="./HomeHelper.html">HomeHelper</a></li>
				
					<li><a href="./HtmlCleaner.html">HtmlCleaner</a></li>
				
					<li><a href="./InboxComment.html">InboxComment</a></li>
				
					<li><a href="./InboxController.html">InboxController</a></li>
				
					<li><a href="./InboxHelper.html">InboxHelper</a></li>
				
					<li><a href="./Invitation.html">Invitation</a></li>
				
					<li><a href="./InvitationsController.html">InvitationsController</a></li>
				
					<li><a href="./InvitationsHelper.html">InvitationsHelper</a></li>
				
					<li><a href="./InviteRequest.html">InviteRequest</a></li>
				
					<li><a href="./InviteRequestsController.html">InviteRequestsController</a></li>
				
					<li><a href="./KnownIssue.html">KnownIssue</a></li>
				
					<li><a href="./KnownIssuesController.html">KnownIssuesController</a></li>
				
					<li><a href="./Kudo.html">Kudo</a></li>
				
					<li><a href="./KudoMailer.html">KudoMailer</a></li>
				
					<li><a href="./KudoObserver.html">KudoObserver</a></li>
				
					<li><a href="./KudosController.html">KudosController</a></li>
				
					<li><a href="./Language.html">Language</a></li>
				
					<li><a href="./LanguagesController.html">LanguagesController</a></li>
				
					<li><a href="./Locale.html">Locale</a></li>
				
					<li><a href="./LocalesController.html">LocalesController</a></li>
				
					<li><a href="./LogItem.html">LogItem</a></li>
				
					<li><a href="./Media.html">Media</a></li>
				
					<li><a href="./MediaController.html">MediaController</a></li>
				
					<li><a href="./MetaTagging.html">MetaTagging</a></li>
				
					<li><a href="./Offer.html">Offer</a></li>
				
					<li><a href="./OrphansController.html">OrphansController</a></li>
				
					<li><a href="./OrphansHelper.html">OrphansHelper</a></li>
				
					<li><a href="./OwnedSetTagging.html">OwnedSetTagging</a></li>
				
					<li><a href="./OwnedTagSet.html">OwnedTagSet</a></li>
				
					<li><a href="./OwnedTagSetsController.html">OwnedTagSetsController</a></li>
				
					<li><a href="./PaginationListLinkRenderer.html">PaginationListLinkRenderer</a></li>
				
					<li><a href="./PasswordsController.html">PasswordsController</a></li>
				
					<li><a href="./People.html">People</a></li>
				
					<li><a href="./PeopleController.html">PeopleController</a></li>
				
					<li><a href="./PotentialMatch.html">PotentialMatch</a></li>
				
					<li><a href="./PotentialMatchSettings.html">PotentialMatchSettings</a></li>
				
					<li><a href="./PotentialMatchesController.html">PotentialMatchesController</a></li>
				
					<li><a href="./PotentialPromptMatch.html">PotentialPromptMatch</a></li>
				
					<li><a href="./Preference.html">Preference</a></li>
				
					<li><a href="./PreferencesController.html">PreferencesController</a></li>
				
					<li><a href="./Profile.html">Profile</a></li>
				
					<li><a href="./ProfileController.html">ProfileController</a></li>
				
					<li><a href="./Prompt.html">Prompt</a></li>
				
					<li><a href="./PromptMeme.html">PromptMeme</a></li>
				
					<li><a href="./PromptRestriction.html">PromptRestriction</a></li>
				
					<li><a href="./PromptRestrictionsHelper.html">PromptRestrictionsHelper</a></li>
				
					<li><a href="./PromptsController.html">PromptsController</a></li>
				
					<li><a href="./Pseud.html">Pseud</a></li>
				
					<li><a href="./PseudSweeper.html">PseudSweeper</a></li>
				
					<li><a href="./PseudsController.html">PseudsController</a></li>
				
					<li><a href="./PseudsHelper.html">PseudsHelper</a></li>
				
					<li><a href="./Query.html">Query</a></li>
				
					<li><a href="./Rating.html">Rating</a></li>
				
					<li><a href="./Rawk.html">Rawk</a></li>
				
					<li><a href="./Reading.html">Reading</a></li>
				
					<li><a href="./ReadingsController.html">ReadingsController</a></li>
				
					<li><a href="./RedirectController.html">RedirectController</a></li>
				
					<li><a href="./RedisTestSetup.html">RedisTestSetup</a></li>
				
					<li><a href="./RelatedWork.html">RelatedWork</a></li>
				
					<li><a href="./RelatedWorksController.html">RelatedWorksController</a></li>
				
					<li><a href="./Relationship.html">Relationship</a></li>
				
					<li><a href="./RelationshipNomination.html">RelationshipNomination</a></li>
				
					<li><a href="./Request.html">Request</a></li>
				
					<li><a href="./Role.html">Role</a></li>
				
					<li><a href="./RolesUser.html">RolesUser</a></li>
				
					<li><a href="./SearchController.html">SearchController</a></li>
				
					<li><a href="./SearchHelper.html">SearchHelper</a></li>
				
					<li><a href="./SerialWork.html">SerialWork</a></li>
				
					<li><a href="./SerialWorksController.html">SerialWorksController</a></li>
				
					<li><a href="./Series.html">Series</a></li>
				
					<li><a href="./SeriesController.html">SeriesController</a></li>
				
					<li><a href="./SeriesHelper.html">SeriesHelper</a></li>
				
					<li><a href="./SetTagging.html">SetTagging</a></li>
				
					<li><a href="./Skin.html">Skin</a></li>
				
					<li><a href="./SkinParent.html">SkinParent</a></li>
				
					<li><a href="./SkinsController.html">SkinsController</a></li>
				
					<li><a href="./SkinsHelper.html">SkinsHelper</a></li>
				
					<li><a href="./SortableList.html">SortableList</a></li>
				
					<li><a href="./Stat.html">Stat</a></li>
				
					<li><a href="./StatHash.html">StatHash</a></li>
				
					<li><a href="./StaticSweeper.html">StaticSweeper</a></li>
				
					<li><a href="./StatsController.html">StatsController</a></li>
				
					<li><a href="./StatsHelper.html">StatsHelper</a></li>
				
					<li><a href="./Subscription.html">Subscription</a></li>
				
					<li><a href="./SubscriptionsController.html">SubscriptionsController</a></li>
				
					<li><a href="./Tag.html">Tag</a></li>
				
					<li><a href="./TagNomination.html">TagNomination</a></li>
				
					<li><a href="./TagNominationsController.html">TagNominationsController</a></li>
				
					<li><a href="./TagSet.html">TagSet</a></li>
				
					<li><a href="./TagSetAssociation.html">TagSetAssociation</a></li>
				
					<li><a href="./TagSetAssociationsController.html">TagSetAssociationsController</a></li>
				
					<li><a href="./TagSetNomination.html">TagSetNomination</a></li>
				
					<li><a href="./TagSetNominationsController.html">TagSetNominationsController</a></li>
				
					<li><a href="./TagSetOwnership.html">TagSetOwnership</a></li>
				
					<li><a href="./TagSetSweeper.html">TagSetSweeper</a></li>
				
					<li><a href="./TagSetsHelper.html">TagSetsHelper</a></li>
				
					<li><a href="./TagSweeper.html">TagSweeper</a></li>
				
					<li><a href="./TagWranglersController.html">TagWranglersController</a></li>
				
					<li><a href="./TagWranglingsController.html">TagWranglingsController</a></li>
				
					<li><a href="./Taggable.html">Taggable</a></li>
				
					<li><a href="./Tagging.html">Tagging</a></li>
				
					<li><a href="./TagsController.html">TagsController</a></li>
				
					<li><a href="./TagsHelper.html">TagsHelper</a></li>
				
					<li><a href="./TranslationGenerator.html">TranslationGenerator</a></li>
				
					<li><a href="./TranslationHelper.html">TranslationHelper</a></li>
				
					<li><a href="./TranslationNote.html">TranslationNote</a></li>
				
					<li><a href="./TranslationNotesController.html">TranslationNotesController</a></li>
				
					<li><a href="./TranslationsController.html">TranslationsController</a></li>
				
					<li><a href="./TranslatorsController.html">TranslatorsController</a></li>
				
					<li><a href="./UrlActiveValidator.html">UrlActiveValidator</a></li>
				
					<li><a href="./UrlFormatValidator.html">UrlFormatValidator</a></li>
				
					<li><a href="./UrlHelpers.html">UrlHelpers</a></li>
				
					<li><a href="./User.html">User</a></li>
				
					<li><a href="./UserInviteRequest.html">UserInviteRequest</a></li>
				
					<li><a href="./UserInviteRequestsController.html">UserInviteRequestsController</a></li>
				
					<li><a href="./UserInviteRequestsHelper.html">UserInviteRequestsHelper</a></li>
				
					<li><a href="./UserMailer.html">UserMailer</a></li>
				
					<li><a href="./UserSession.html">UserSession</a></li>
				
					<li><a href="./UserSessionsController.html">UserSessionsController</a></li>
				
					<li><a href="./UsersController.html">UsersController</a></li>
				
					<li><a href="./UsersHelper.html">UsersHelper</a></li>
				
					<li><a href="./ValidationHelper.html">ValidationHelper</a></li>
				
					<li><a href="./Warning.html">Warning</a></li>
				
					<li><a href="./WeightedRandom.html">WeightedRandom</a></li>
				
					<li><a href="./Work.html">Work</a></li>
				
					<li><a href="./WorkObserver.html">WorkObserver</a></li>
				
					<li><a href="./WorkSkin.html">WorkSkin</a></li>
				
					<li><a href="./WorkSweeper.html">WorkSweeper</a></li>
				
					<li><a href="./WorksController.html">WorksController</a></li>
				
					<li><a href="./WorksHelper.html">WorksHelper</a></li>
				
					<li><a href="./WranglingAssignment.html">WranglingAssignment</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">TagsController</h1>

		<div id="description">
			
		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="create-method" class="method-detail ">
				<a name="method-i-create"></a>

				<div class="method-heading">
				
					<span class="method-name">create</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
POST /tags POST /tags.xml
</p>
					

					
					<div class="method-source-code"
						id="create-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 151</span>
151:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>
152:     <span class="ruby-identifier">type</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>][<span class="ruby-value">:type</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>]
153:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type</span>
154:       <span class="ruby-identifier">model</span> = <span class="ruby-identifier">type</span>.<span class="ruby-identifier">classify</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
155:       <span class="ruby-ivar">@tag</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">find_or_create_by_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>][<span class="ruby-value">:name</span>])  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Class</span>
156:     <span class="ruby-keyword kw">else</span>
157:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'please_provide_category'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Please provide a category.&quot;</span>)
158:       <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>][<span class="ruby-value">:name</span>])
159:       <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
160:     <span class="ruby-keyword kw">end</span>
161:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">valid?</span>
162:       <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>][<span class="ruby-value">:name</span>]) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>][<span class="ruby-value">:name</span>].<span class="ruby-identifier">downcase</span>) <span class="ruby-comment cmt"># only capitalization different</span>
163:         <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:name</span>, <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>][<span class="ruby-value">:name</span>])  <span class="ruby-comment cmt"># use the new capitalization</span>
164:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'successfully_modified'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Tag was successfully modified.'</span>)
165:       <span class="ruby-keyword kw">else</span>
166:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'successfully_created'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Tag was successfully created.'</span>)
167:       <span class="ruby-keyword kw">end</span>
168:       <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:canonical</span>, <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>][<span class="ruby-value">:canonical</span>])
169:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">url_for</span>(<span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;tags&quot;</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit&quot;</span>, <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@tag</span>)
170:     <span class="ruby-keyword kw">else</span>
171:       <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
172:     <span class="ruby-keyword kw">end</span>
173:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="edit-method" class="method-detail ">
				<a name="method-i-edit"></a>

				<div class="method-heading">
				
					<span class="method-name">edit</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="edit-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 175</span>
175:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">edit</span>
176:     <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
177:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Banned</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">logged_in_as_admin?</span>
178:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'errors.log_in_as_admin'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Please log in as admin&quot;</span>)
179:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">tag_wranglings_path</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
180:     <span class="ruby-keyword kw">end</span>
181:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@tag</span>
182:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>, <span class="ruby-node">&quot;Couldn't find tag named '#{params[:id]}'&quot;</span>
183:     <span class="ruby-keyword kw">end</span>
184:     <span class="ruby-ivar">@counts</span> = {}
185:     <span class="ruby-ivar">@uses</span> = [<span class="ruby-value str">'Works'</span>, <span class="ruby-value str">'Drafts'</span>, <span class="ruby-value str">'Bookmarks'</span>, <span class="ruby-value str">'Private Bookmarks'</span>, <span class="ruby-value str">'External Works'</span>]
186:     <span class="ruby-ivar">@counts</span>[<span class="ruby-value str">'Works'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">visible_works_count</span>
187:     <span class="ruby-ivar">@counts</span>[<span class="ruby-value str">'Drafts'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">unposted</span>.<span class="ruby-identifier">count</span>
188:     <span class="ruby-ivar">@counts</span>[<span class="ruby-value str">'Bookmarks'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">visible_bookmarks_count</span>
189:     <span class="ruby-ivar">@counts</span>[<span class="ruby-value str">'Private Bookmarks'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">bookmarks</span>.<span class="ruby-identifier">not_public</span>.<span class="ruby-identifier">count</span>
190:     <span class="ruby-ivar">@counts</span>[<span class="ruby-value str">'External Works'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">visible_external_works_count</span>
191: 
192:     <span class="ruby-ivar">@parents</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">parents</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:name</span>).<span class="ruby-identifier">group_by</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tag</span>[<span class="ruby-value">:type</span>]}
193:     <span class="ruby-ivar">@parents</span>[<span class="ruby-value str">'MetaTag'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">direct_meta_tags</span>.<span class="ruby-identifier">by_name</span>
194:     <span class="ruby-ivar">@children</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:name</span>).<span class="ruby-identifier">group_by</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tag</span>[<span class="ruby-value">:type</span>]}
195:     <span class="ruby-ivar">@children</span>[<span class="ruby-value str">'SubTag'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">direct_sub_tags</span>.<span class="ruby-identifier">by_name</span>
196:     <span class="ruby-ivar">@children</span>[<span class="ruby-value str">'Merger'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">mergers</span>.<span class="ruby-identifier">by_name</span>
197:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:wranglers</span>)
198:       <span class="ruby-ivar">@wranglers</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">canonical</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">wranglers</span> <span class="ruby-operator">:</span> (<span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">merger</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">merger</span>.<span class="ruby-identifier">wranglers</span> <span class="ruby-operator">:</span> [])
199:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:fandoms</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">fandoms</span>.<span class="ruby-identifier">empty?</span>
200:       <span class="ruby-ivar">@wranglers</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">fandoms</span>.<span class="ruby-identifier">collect</span>(&amp;<span class="ruby-value">:wranglers</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>
201:     <span class="ruby-keyword kw">end</span>
202:     <span class="ruby-ivar">@suggested_fandoms</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">suggested_fandoms</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">fandoms</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:fandoms</span>)
203:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="feed-method" class="method-detail ">
				<a name="method-i-feed"></a>

				<div class="method-heading">
				
					<span class="method-name">feed</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="feed-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 84</span>
 84:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">feed</span>
 85:     <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
 86:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">canonical?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">merger</span>
 87:       <span class="ruby-ivar">@tag</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">merger</span>
 88:     <span class="ruby-keyword kw">end</span>
 89:     <span class="ruby-comment cmt"># Temp for testing</span>
 90:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;F/F&quot;</span>
 91:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">canonical?</span>
 92:         <span class="ruby-ivar">@works</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">filtered_works</span>.<span class="ruby-identifier">visible_to_all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;created_at DESC&quot;</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">25</span>)
 93:       <span class="ruby-keyword kw">else</span>
 94:         <span class="ruby-ivar">@works</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible_to_all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;created_at DESC&quot;</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">25</span>)
 95:       <span class="ruby-keyword kw">end</span>
 96:     <span class="ruby-keyword kw">else</span>
 97:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">tag_works_path</span>(<span class="ruby-value">:tag_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">to_param</span>)
 98:     <span class="ruby-keyword kw">end</span>
 99: 
100:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
101:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span>
102:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">atom</span>
103:     <span class="ruby-keyword kw">end</span>
104:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="index-method" class="method-detail ">
				<a name="method-i-index"></a>

				<div class="method-heading">
				
					<span class="method-name">index</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
GET /tags GET /tags.xml
</p>
					

					
					<div class="method-source-code"
						id="index-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 12</span>
12:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
13:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@collection</span>
14:       <span class="ruby-ivar">@tags</span> = <span class="ruby-constant">Freeform</span>.<span class="ruby-identifier">canonical</span>.<span class="ruby-identifier">for_collections_with_count</span>([<span class="ruby-ivar">@collection</span>] <span class="ruby-operator">+</span> <span class="ruby-ivar">@collection</span>.<span class="ruby-identifier">children</span>)
15:     <span class="ruby-keyword kw">else</span>
16:       <span class="ruby-identifier">no_fandom</span> = <span class="ruby-constant">Fandom</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">FANDOM_NO_TAG_NAME</span>)
17:       <span class="ruby-ivar">@tags</span> = <span class="ruby-identifier">no_fandom</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">by_type</span>(<span class="ruby-value str">&quot;Freeform&quot;</span>).<span class="ruby-identifier">first_class</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">TAGS_IN_CLOUD</span>)
18:       <span class="ruby-comment cmt"># have to put canonical at the end so that it doesn't overwrite sort order for random and popular</span>
19:       <span class="ruby-comment cmt"># and then sort again at the very end to make it alphabetic</span>
20:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:show</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;random&quot;</span>
21:         <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tags</span>.<span class="ruby-identifier">random</span>.<span class="ruby-identifier">canonical</span>.<span class="ruby-identifier">sort</span>
22:       <span class="ruby-keyword kw">else</span>
23:         <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tags</span>.<span class="ruby-identifier">popular</span>.<span class="ruby-identifier">canonical</span>.<span class="ruby-identifier">sort</span>
24:       <span class="ruby-keyword kw">end</span>
25:     <span class="ruby-keyword kw">end</span>
26: 
27:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
28:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment cmt"># index.html.erb</span>
29:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">js</span>
30:     <span class="ruby-keyword kw">end</span>
31:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="mass-update-method" class="method-detail ">
				<a name="method-i-mass_update"></a>

				<div class="method-heading">
				
					<span class="method-name">mass_update</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="mass-update-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 273</span>
273:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">mass_update</span>
274:     <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>] = <span class="ruby-value str">'1'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">blank?</span>
275:     <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>] = <span class="ruby-value str">'name'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">valid_sort_column</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>], <span class="ruby-value str">'tag'</span>)
276:     <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>] = <span class="ruby-value str">'ASC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">valid_sort_direction</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>])
277:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:canonicals</span>].<span class="ruby-identifier">blank?</span>
278:       <span class="ruby-identifier">saved</span> = []
279:       <span class="ruby-identifier">not_saved</span> = []
280:       <span class="ruby-identifier">params</span>[<span class="ruby-value">:canonicals</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tag_id</span><span class="ruby-operator">|</span>
281:         <span class="ruby-identifier">tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">tag_id</span>)
282:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tag</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-value">:canonical</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
283:           <span class="ruby-identifier">saved</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tag</span>
284:         <span class="ruby-keyword kw">else</span>
285:           <span class="ruby-identifier">not_saved</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tag</span>
286:         <span class="ruby-keyword kw">end</span>
287:       <span class="ruby-keyword kw">end</span>
288:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">not_saved</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">saved</span>.<span class="ruby-identifier">empty?</span>
289:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-node">&quot;The following tags were successfully updated: #{saved.collect(&amp;:name).join(', ')}&quot;</span>
290:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">not_saved</span>.<span class="ruby-identifier">empty?</span>
291:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-node">&quot;The following tags weren't saved: #{not_saved.collect(&amp;:name).join(', ')}&quot;</span>
292:       <span class="ruby-keyword kw">end</span>
293:     <span class="ruby-keyword kw">end</span>
294:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">url_for</span>(<span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:tags</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:wrangle</span>, <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>], <span class="ruby-value">:show</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:show</span>], <span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>], <span class="ruby-value">:sort_column</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>], <span class="ruby-value">:sort_direction</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>], <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:status</span>])
295:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="new-method" class="method-detail ">
				<a name="method-i-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
GET /tags/new GET /tags/new.xml
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 141</span>
141:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new</span>
142:     <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">new</span>
143: 
144:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
145:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment cmt"># new.html.erb</span>
146:     <span class="ruby-keyword kw">end</span>
147:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="remove-association-method" class="method-detail ">
				<a name="method-i-remove_association"></a>

				<div class="method-heading">
				
					<span class="method-name">remove_association</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="remove-association-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 232</span>
232:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_association</span>
233:     <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
234:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@tag</span>
235:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>, <span class="ruby-node">&quot;Couldn't find tag named '#{params[:id]}'&quot;</span>
236:     <span class="ruby-keyword kw">end</span>
237:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:to_remove</span>]
238:       <span class="ruby-identifier">tag_to_remove</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:to_remove</span>])
239:       <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">remove_association</span>(<span class="ruby-identifier">tag_to_remove</span>)
240:     <span class="ruby-keyword kw">end</span>
241:     <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'successfully_updated'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Tag was updated.'</span>)
242:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">url_for</span>(<span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;tags&quot;</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit&quot;</span>, <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@tag</span>)
243:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="search-method" class="method-detail ">
				<a name="method-i-search"></a>

				<div class="method-heading">
				
					<span class="method-name">search</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="search-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 33</span>
33:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search</span>
34:     <span class="ruby-ivar">@query</span> = {}
35:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:query</span>]
36:       <span class="ruby-ivar">@query</span> = <span class="ruby-constant">Query</span>.<span class="ruby-identifier">standardize</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:query</span>])
37:       <span class="ruby-keyword kw">begin</span>
38:         <span class="ruby-identifier">page</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>] <span class="ruby-operator">||</span> <span class="ruby-value">1</span>
39:         <span class="ruby-identifier">errors</span>, <span class="ruby-ivar">@tags</span> = <span class="ruby-constant">Query</span>.<span class="ruby-identifier">search_with_sphinx</span>(<span class="ruby-constant">Tag</span>, <span class="ruby-ivar">@query</span>, <span class="ruby-identifier">page</span>)
40:         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">blank?</span>
41:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Riddle</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionError</span>
42:         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;The search engine seems to be down at the moment, sorry!&quot;</span>)
43:       <span class="ruby-keyword kw">end</span>
44:     <span class="ruby-keyword kw">end</span>
45:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="show-method" class="method-detail ">
				<a name="method-i-show"></a>

				<div class="method-heading">
				
					<span class="method-name">show</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
if user is <a href="Admin.html">Admin</a> or <a href="Tag.html">Tag</a>
Wrangler, show them details about the tag if user is not logged in or a
regular user, show them
</p>
<pre>
  1. the works, if the tag had been wrangled and we can redirect them to works using it or its canonical merger
  2. the tag, the works and the bookmarks using it, if the tag is unwrangled (because we can't redirect them
      to the works controller)</pre>
					

					
					<div class="method-source-code"
						id="show-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 52</span>
52:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show</span>
53:     <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
54:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Tag</span>
55:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Banned</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">logged_in_as_admin?</span>
56:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'errors.log_in_as_admin'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Please log in as admin&quot;</span>)
57:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">tag_wranglings_path</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
58:       <span class="ruby-keyword kw">end</span>
59:       <span class="ruby-comment cmt"># if tag is NOT wrangled, prepare to show works and bookmarks that are using it</span>
60:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">canonical</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">merger</span>
61:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">logged_in?</span> <span class="ruby-comment cmt">#current_user.is_a?User</span>
62:           <span class="ruby-ivar">@works</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible_to_registered_user</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>])
63:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">logged_in_as_admin?</span>
64:           <span class="ruby-ivar">@works</span>= <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible_to_owner</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>])
65:         <span class="ruby-keyword kw">else</span>
66:           <span class="ruby-ivar">@works</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible_to_all</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>])
67:         <span class="ruby-keyword kw">end</span>
68:         <span class="ruby-ivar">@bookmarks</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">bookmarks</span>.<span class="ruby-identifier">visible</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>])
69:       <span class="ruby-keyword kw">end</span>
70:       <span class="ruby-comment cmt"># if regular user or anonymous (not logged in) visitor, AND the tag is wrangled, just give them the goodies</span>
71:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">logged_in?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_tag_wrangler?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">logged_in_as_admin?</span>)
72:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">canonical</span> <span class="ruby-comment cmt"># show works with that tag</span>
73:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">url_for</span>(<span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:works</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:index</span>, <span class="ruby-value">:tag_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@tag</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
74:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">merger</span> <span class="ruby-comment cmt"># show works with the canonical merger (synonym) of that tag</span>
75:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">url_for</span>(<span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:works</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:index</span>, <span class="ruby-value">:tag_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">merger</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
76:         <span class="ruby-keyword kw">end</span>
77:       <span class="ruby-keyword kw">end</span>
78:     <span class="ruby-keyword kw">else</span>
79:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'not_found'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Tag not found&quot;</span>)
80:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-value str">'/'</span>
81:     <span class="ruby-keyword kw">end</span>
82:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="show-hidden-method" class="method-detail ">
				<a name="method-i-show_hidden"></a>

				<div class="method-heading">
				
					<span class="method-name">show_hidden</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="show-hidden-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show_hidden</span>
107:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:creation_id</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:creation_type</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag_type</span>].<span class="ruby-identifier">blank?</span>
108:       <span class="ruby-identifier">model</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:creation_type</span>].<span class="ruby-identifier">classify</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
109:       <span class="ruby-ivar">@display_creation</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:creation_id</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Class</span>
110:       <span class="ruby-comment cmt"># Tags aren't directly on series, so we need to handle them differently</span>
111:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:creation_type</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'Series'</span>
112:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag_type</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'warnings'</span>
113:           <span class="ruby-ivar">@display_tags</span> = <span class="ruby-ivar">@display_creation</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible</span>.<span class="ruby-identifier">collect</span>(&amp;<span class="ruby-value">:warning_tags</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">sort</span>
114:         <span class="ruby-keyword kw">else</span>
115:           <span class="ruby-ivar">@display_tags</span> = <span class="ruby-ivar">@display_creation</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible</span>.<span class="ruby-identifier">collect</span>(&amp;<span class="ruby-value">:freeform_tags</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">sort</span>
116:         <span class="ruby-keyword kw">end</span>
117:       <span class="ruby-keyword kw">else</span>
118:         <span class="ruby-keyword kw">if</span> <span class="ruby-node">%(warnings freeforms)</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:tag_type</span>])
119:           <span class="ruby-ivar">@display_tags</span> = <span class="ruby-ivar">@display_creation</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:tag_type</span>]).<span class="ruby-identifier">sort</span>
120:         <span class="ruby-keyword kw">end</span>
121:       <span class="ruby-keyword kw">end</span>
122:       <span class="ruby-ivar">@display_category</span> = <span class="ruby-ivar">@display_tags</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">pluralize</span>
123:     <span class="ruby-keyword kw">end</span>
124:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
125:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-keyword kw">do</span>
126:         <span class="ruby-comment cmt"># This is just a quick fix to avoid script barf if JavaScript is disabled</span>
127:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'need_javascript'</span>, <span class="ruby-value">:default</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Sorry, you need to have JavaScript enabled for this.&quot;</span>)
128:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">&quot;HTTP_REFERER&quot;</span>]
129:           <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">&quot;HTTP_REFERER&quot;</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">root_path</span>)
130:         <span class="ruby-keyword kw">else</span>
131:           <span class="ruby-comment cmt"># else branch needed to deal with bots, which don't have a referer</span>
132:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-value str">'/'</span>
133:         <span class="ruby-keyword kw">end</span>
134:       <span class="ruby-keyword kw">end</span>
135:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">js</span>
136:     <span class="ruby-keyword kw">end</span>
137:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="update-method" class="method-detail ">
				<a name="method-i-update"></a>

				<div class="method-heading">
				
					<span class="method-name">update</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="update-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 205</span>
205:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>
206:     <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
207:     <span class="ruby-comment cmt"># update everything except for the synonym,</span>
208:     <span class="ruby-comment cmt"># so that the associations are there to move when the synonym is created</span>
209:     <span class="ruby-identifier">syn_string</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>].<span class="ruby-identifier">delete</span>(<span class="ruby-value">:syn_string</span>)
210:     <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:tag</span>]
211:     <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">syn_string</span> = <span class="ruby-identifier">syn_string</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">save</span>
212:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">save</span>
213:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">'Tag was updated.'</span>)
214:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:commit</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Wrangle&quot;</span>
215:         <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>] = <span class="ruby-value str">'1'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">blank?</span>
216:         <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>] = <span class="ruby-value str">'name'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">valid_sort_column</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>], <span class="ruby-value str">&quot;tag&quot;</span>)
217:         <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>] = <span class="ruby-value str">'ASC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">valid_sort_direction</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>])
218:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">url_for</span>(<span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:tags</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:wrangle</span>, <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>], <span class="ruby-value">:show</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:show</span>], <span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>], <span class="ruby-value">:sort_column</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>], <span class="ruby-value">:sort_direction</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>], <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:status</span>])
219:       <span class="ruby-keyword kw">else</span>
220:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">url_for</span>(<span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;tags&quot;</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit&quot;</span>, <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@tag</span>)
221:       <span class="ruby-keyword kw">end</span>
222:     <span class="ruby-keyword kw">else</span>
223:       <span class="ruby-ivar">@parents</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">parents</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:name</span>).<span class="ruby-identifier">group_by</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tag</span>[<span class="ruby-value">:type</span>]}
224:       <span class="ruby-ivar">@parents</span>[<span class="ruby-value str">'MetaTag'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">direct_meta_tags</span>.<span class="ruby-identifier">by_name</span>
225:       <span class="ruby-ivar">@children</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:name</span>).<span class="ruby-identifier">group_by</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tag</span>[<span class="ruby-value">:type</span>]}
226:       <span class="ruby-ivar">@children</span>[<span class="ruby-value str">'SubTag'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">direct_sub_tags</span>.<span class="ruby-identifier">by_name</span>
227:       <span class="ruby-ivar">@children</span>[<span class="ruby-value str">'Merger'</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">mergers</span>.<span class="ruby-identifier">by_name</span>
228:       <span class="ruby-identifier">render</span> <span class="ruby-value">:edit</span>
229:     <span class="ruby-keyword kw">end</span>
230:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="wrangle-method" class="method-detail ">
				<a name="method-i-wrangle"></a>

				<div class="method-heading">
				
					<span class="method-name">wrangle</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="wrangle-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/tags_controller.rb, line 245</span>
245:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wrangle</span>
246:     <span class="ruby-ivar">@tag</span> = <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
247:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@tag</span>
248:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>, <span class="ruby-node">&quot;Couldn't find tag named '#{params[:id]}'&quot;</span>
249:     <span class="ruby-keyword kw">end</span>
250:     <span class="ruby-ivar">@counts</span> = {}
251:     <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">child_types</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">underscore</span>.<span class="ruby-identifier">pluralize</span>.<span class="ruby-identifier">to_sym</span>}.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tag_type</span><span class="ruby-operator">|</span>
252:       <span class="ruby-ivar">@counts</span>[<span class="ruby-identifier">tag_type</span>] = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">tag_type</span>).<span class="ruby-identifier">count</span>
253:     <span class="ruby-keyword kw">end</span>
254: 
255:     <span class="ruby-keyword kw">if</span> <span class="ruby-node">%(fandoms characters relationships freeforms sub_tags mergers)</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:show</span>])
256:       <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>] = <span class="ruby-value str">'name'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">valid_sort_column</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>], <span class="ruby-value str">'tag'</span>)
257:       <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>] = <span class="ruby-value str">'ASC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">valid_sort_direction</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>])
258:       <span class="ruby-identifier">sort</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_column</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort_direction</span>]
259:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sort</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">'suggested'</span>)
260:         <span class="ruby-identifier">sort</span> = <span class="ruby-identifier">sort</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;, name ASC&quot;</span>
261:       <span class="ruby-keyword kw">end</span>
262:       <span class="ruby-comment cmt"># this makes sure params[:status] is safe</span>
263:       <span class="ruby-keyword kw">if</span> <span class="ruby-node">%(unfilterable canonical noncanonical)</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:status</span>])
264:         <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:show</span>]).<span class="ruby-identifier">order</span>(<span class="ruby-identifier">sort</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:status</span>]).<span class="ruby-identifier">paginate</span>(<span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>], <span class="ruby-value">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">ITEMS_PER_PAGE</span>)
265:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:status</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;unwrangled&quot;</span>
266:         <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">same_work_tags</span>.<span class="ruby-identifier">unwrangled</span>.<span class="ruby-identifier">by_type</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:show</span>].<span class="ruby-identifier">singularize</span>.<span class="ruby-identifier">camelize</span>).<span class="ruby-identifier">order</span>(<span class="ruby-identifier">sort</span>).<span class="ruby-identifier">paginate</span>(<span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>], <span class="ruby-value">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">ITEMS_PER_PAGE</span>)
267:       <span class="ruby-keyword kw">else</span>
268:         <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tag</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:show</span>]).<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">sort</span>).<span class="ruby-identifier">paginate</span>(<span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:page</span>], <span class="ruby-value">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">ITEMS_PER_PAGE</span>)
269:       <span class="ruby-keyword kw">end</span>
270:     <span class="ruby-keyword kw">end</span>
271:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

