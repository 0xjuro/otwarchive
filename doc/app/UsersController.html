<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: UsersController</title>

	<link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="./app/controllers/users_controller_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link"><a href="ApplicationController.html">ApplicationController</a></p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-i-activate">#activate</a></li>
					
					<li><a href="#method-i-browse">#browse</a></li>
					
					<li><a href="#method-i-change_email">#change_email</a></li>
					
					<li><a href="#method-i-change_openid">#change_openid</a></li>
					
					<li><a href="#method-i-change_password">#change_password</a></li>
					
					<li><a href="#method-i-change_username">#change_username</a></li>
					
					<li><a href="#method-i-check_account_creation_status">#check_account_creation_status</a></li>
					
					<li><a href="#method-i-create">#create</a></li>
					
					<li><a href="#method-i-delete_confirmation">#delete_confirmation</a></li>
					
					<li><a href="#method-i-destroy">#destroy</a></li>
					
					<li><a href="#method-i-edit">#edit</a></li>
					
					<li><a href="#method-i-end_banner">#end_banner</a></li>
					
					<li><a href="#method-i-end_first_login">#end_first_login</a></li>
					
					<li><a href="#method-i-index">#index</a></li>
					
					<li><a href="#method-i-load_user">#load_user</a></li>
					
					<li><a href="#method-i-new">#new</a></li>
					
					<li><a href="#method-i-reauthenticate">#reauthenticate</a></li>
					
					<li><a href="#method-i-show">#show</a></li>
					
					<li><a href="#method-i-update">#update</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="./doc/README_FOR_APP.html">README_FOR_APP</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./Static.html">Static</a></li>
				
					<li><a href="./Static/BaseController.html">Static::BaseController</a></li>
				
					<li><a href="./Static/CollectionsController.html">Static::CollectionsController</a></li>
				
					<li><a href="./Static/FandomsController.html">Static::FandomsController</a></li>
				
					<li><a href="./Static/MediaController.html">Static::MediaController</a></li>
				
					<li><a href="./Static/RestrictedWorksController.html">Static::RestrictedWorksController</a></li>
				
					<li><a href="./Static/WorksController.html">Static::WorksController</a></li>
				
					<li><a href="./Admin.html">Admin</a></li>
				
					<li><a href="./Admin/AdminInvitationsController.html">Admin::AdminInvitationsController</a></li>
				
					<li><a href="./Admin/AdminUsersController.html">Admin::AdminUsersController</a></li>
				
					<li><a href="./Admin/SettingsController.html">Admin::SettingsController</a></li>
				
					<li><a href="./Admin/SkinsController.html">Admin::SkinsController</a></li>
				
					<li><a href="./Admin/UserCreationsController.html">Admin::UserCreationsController</a></li>
				
					<li><a href="./ActionController.html">ActionController</a></li>
				
					<li><a href="./ActionController/Routing.html">ActionController::Routing</a></li>
				
					<li><a href="./ActionController/Routing/RouteSet.html">ActionController::Routing::RouteSet</a></li>
				
					<li><a href="./Challenge.html">Challenge</a></li>
				
					<li><a href="./Challenge/GiftExchangeController.html">Challenge::GiftExchangeController</a></li>
				
					<li><a href="./Challenge/PromptMemeController.html">Challenge::PromptMemeController</a></li>
				
					<li><a href="./ActiveRecord.html">ActiveRecord</a></li>
				
					<li><a href="./AutocompleteSource.html">AutocompleteSource</a></li>
				
					<li><a href="./AutocompleteSource/ClassMethods.html">AutocompleteSource::ClassMethods</a></li>
				
					<li><a href="./ChallengeCore.html">ChallengeCore</a></li>
				
					<li><a href="./ChallengeCore/ClassMethods.html">ChallengeCore::ClassMethods</a></li>
				
					<li><a href="./StoryParser.html">StoryParser</a></li>
				
					<li><a href="./StoryParser/Error.html">StoryParser::Error</a></li>
				
					<li><a href="./XhtmlSplitter.html">XhtmlSplitter</a></li>
				
					<li><a href="./XhtmlSplitter/Error.html">XhtmlSplitter::Error</a></li>
				
					<li><a href="./AbuseReport.html">AbuseReport</a></li>
				
					<li><a href="./AbuseReportsController.html">AbuseReportsController</a></li>
				
					<li><a href="./AdminMailer.html">AdminMailer</a></li>
				
					<li><a href="./AdminPost.html">AdminPost</a></li>
				
					<li><a href="./AdminPostTag.html">AdminPostTag</a></li>
				
					<li><a href="./AdminPostTagging.html">AdminPostTagging</a></li>
				
					<li><a href="./AdminPostsController.html">AdminPostsController</a></li>
				
					<li><a href="./AdminSession.html">AdminSession</a></li>
				
					<li><a href="./AdminSessionsController.html">AdminSessionsController</a></li>
				
					<li><a href="./AdminSetting.html">AdminSetting</a></li>
				
					<li><a href="./AdminsController.html">AdminsController</a></li>
				
					<li><a href="./AdvancedSearchHelper.html">AdvancedSearchHelper</a></li>
				
					<li><a href="./AlphabetHelper.html">AlphabetHelper</a></li>
				
					<li><a href="./ApplicationController.html">ApplicationController</a></li>
				
					<li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
				
					<li><a href="./ArchiveFaq.html">ArchiveFaq</a></li>
				
					<li><a href="./ArchiveFaqsController.html">ArchiveFaqsController</a></li>
				
					<li><a href="./AuthlogicHelpersForMailers.html">AuthlogicHelpersForMailers</a></li>
				
					<li><a href="./AutocompleteController.html">AutocompleteController</a></li>
				
					<li><a href="./Banned.html">Banned</a></li>
				
					<li><a href="./Bookmark.html">Bookmark</a></li>
				
					<li><a href="./BookmarksController.html">BookmarksController</a></li>
				
					<li><a href="./BookmarksHelper.html">BookmarksHelper</a></li>
				
					<li><a href="./CacheHelper.html">CacheHelper</a></li>
				
					<li><a href="./CastNomination.html">CastNomination</a></li>
				
					<li><a href="./Category.html">Category</a></li>
				
					<li><a href="./ChallengeAssignment.html">ChallengeAssignment</a></li>
				
					<li><a href="./ChallengeAssignmentsController.html">ChallengeAssignmentsController</a></li>
				
					<li><a href="./ChallengeClaim.html">ChallengeClaim</a></li>
				
					<li><a href="./ChallengeClaimsController.html">ChallengeClaimsController</a></li>
				
					<li><a href="./ChallengeHelper.html">ChallengeHelper</a></li>
				
					<li><a href="./ChallengeRequestsController.html">ChallengeRequestsController</a></li>
				
					<li><a href="./ChallengeSignup.html">ChallengeSignup</a></li>
				
					<li><a href="./ChallengeSignupObserver.html">ChallengeSignupObserver</a></li>
				
					<li><a href="./ChallengeSignupSweeper.html">ChallengeSignupSweeper</a></li>
				
					<li><a href="./ChallengeSignupsController.html">ChallengeSignupsController</a></li>
				
					<li><a href="./ChallengeSweeper.html">ChallengeSweeper</a></li>
				
					<li><a href="./ChallengesController.html">ChallengesController</a></li>
				
					<li><a href="./Chapter.html">Chapter</a></li>
				
					<li><a href="./ChapterSweeper.html">ChapterSweeper</a></li>
				
					<li><a href="./ChaptersController.html">ChaptersController</a></li>
				
					<li><a href="./ChaptersHelper.html">ChaptersHelper</a></li>
				
					<li><a href="./Character.html">Character</a></li>
				
					<li><a href="./CharacterNomination.html">CharacterNomination</a></li>
				
					<li><a href="./Collectible.html">Collectible</a></li>
				
					<li><a href="./Collection.html">Collection</a></li>
				
					<li><a href="./CollectionItem.html">CollectionItem</a></li>
				
					<li><a href="./CollectionItemsController.html">CollectionItemsController</a></li>
				
					<li><a href="./CollectionObserver.html">CollectionObserver</a></li>
				
					<li><a href="./CollectionParticipant.html">CollectionParticipant</a></li>
				
					<li><a href="./CollectionParticipantsController.html">CollectionParticipantsController</a></li>
				
					<li><a href="./CollectionPreference.html">CollectionPreference</a></li>
				
					<li><a href="./CollectionProfile.html">CollectionProfile</a></li>
				
					<li><a href="./CollectionProfileController.html">CollectionProfileController</a></li>
				
					<li><a href="./CollectionSweeper.html">CollectionSweeper</a></li>
				
					<li><a href="./CollectionsController.html">CollectionsController</a></li>
				
					<li><a href="./CollectionsHelper.html">CollectionsHelper</a></li>
				
					<li><a href="./Comment.html">Comment</a></li>
				
					<li><a href="./CommentMailer.html">CommentMailer</a></li>
				
					<li><a href="./CommentObserver.html">CommentObserver</a></li>
				
					<li><a href="./CommentSweeper.html">CommentSweeper</a></li>
				
					<li><a href="./CommentsController.html">CommentsController</a></li>
				
					<li><a href="./CommentsHelper.html">CommentsHelper</a></li>
				
					<li><a href="./CommonTagging.html">CommonTagging</a></li>
				
					<li><a href="./CreationObserver.html">CreationObserver</a></li>
				
					<li><a href="./Creatorship.html">Creatorship</a></li>
				
					<li><a href="./CssCleaner.html">CssCleaner</a></li>
				
					<li><a href="./DateHelper.html">DateHelper</a></li>
				
					<li><a href="./DevmodeController.html">DevmodeController</a></li>
				
					<li><a href="./DownloadsController.html">DownloadsController</a></li>
				
					<li><a href="./EmailVeracityValidator.html">EmailVeracityValidator</a></li>
				
					<li><a href="./ErrorsController.html">ErrorsController</a></li>
				
					<li><a href="./ExternalAuthor.html">ExternalAuthor</a></li>
				
					<li><a href="./ExternalAuthorName.html">ExternalAuthorName</a></li>
				
					<li><a href="./ExternalAuthorsController.html">ExternalAuthorsController</a></li>
				
					<li><a href="./ExternalAuthorsHelper.html">ExternalAuthorsHelper</a></li>
				
					<li><a href="./ExternalCreatorship.html">ExternalCreatorship</a></li>
				
					<li><a href="./ExternalWork.html">ExternalWork</a></li>
				
					<li><a href="./ExternalWorksController.html">ExternalWorksController</a></li>
				
					<li><a href="./Fandom.html">Fandom</a></li>
				
					<li><a href="./FandomNomination.html">FandomNomination</a></li>
				
					<li><a href="./FandomsController.html">FandomsController</a></li>
				
					<li><a href="./FeedSweeper.html">FeedSweeper</a></li>
				
					<li><a href="./Feedback.html">Feedback</a></li>
				
					<li><a href="./FeedbacksController.html">FeedbacksController</a></li>
				
					<li><a href="./FilterCount.html">FilterCount</a></li>
				
					<li><a href="./FilterTagging.html">FilterTagging</a></li>
				
					<li><a href="./FindRandom.html">FindRandom</a></li>
				
					<li><a href="./Freeform.html">Freeform</a></li>
				
					<li><a href="./FreeformNomination.html">FreeformNomination</a></li>
				
					<li><a href="./Gift.html">Gift</a></li>
				
					<li><a href="./GiftExchange.html">GiftExchange</a></li>
				
					<li><a href="./GiftsController.html">GiftsController</a></li>
				
					<li><a href="./HitCounter.html">HitCounter</a></li>
				
					<li><a href="./HomeController.html">HomeController</a></li>
				
					<li><a href="./HomeHelper.html">HomeHelper</a></li>
				
					<li><a href="./HtmlCleaner.html">HtmlCleaner</a></li>
				
					<li><a href="./InboxComment.html">InboxComment</a></li>
				
					<li><a href="./InboxController.html">InboxController</a></li>
				
					<li><a href="./InboxHelper.html">InboxHelper</a></li>
				
					<li><a href="./Invitation.html">Invitation</a></li>
				
					<li><a href="./InvitationsController.html">InvitationsController</a></li>
				
					<li><a href="./InvitationsHelper.html">InvitationsHelper</a></li>
				
					<li><a href="./InviteRequest.html">InviteRequest</a></li>
				
					<li><a href="./InviteRequestsController.html">InviteRequestsController</a></li>
				
					<li><a href="./KnownIssue.html">KnownIssue</a></li>
				
					<li><a href="./KnownIssuesController.html">KnownIssuesController</a></li>
				
					<li><a href="./Kudo.html">Kudo</a></li>
				
					<li><a href="./KudoMailer.html">KudoMailer</a></li>
				
					<li><a href="./KudoObserver.html">KudoObserver</a></li>
				
					<li><a href="./KudosController.html">KudosController</a></li>
				
					<li><a href="./Language.html">Language</a></li>
				
					<li><a href="./LanguagesController.html">LanguagesController</a></li>
				
					<li><a href="./Locale.html">Locale</a></li>
				
					<li><a href="./LocalesController.html">LocalesController</a></li>
				
					<li><a href="./LogItem.html">LogItem</a></li>
				
					<li><a href="./Media.html">Media</a></li>
				
					<li><a href="./MediaController.html">MediaController</a></li>
				
					<li><a href="./MetaTagging.html">MetaTagging</a></li>
				
					<li><a href="./Offer.html">Offer</a></li>
				
					<li><a href="./OrphansController.html">OrphansController</a></li>
				
					<li><a href="./OrphansHelper.html">OrphansHelper</a></li>
				
					<li><a href="./OwnedSetTagging.html">OwnedSetTagging</a></li>
				
					<li><a href="./OwnedTagSet.html">OwnedTagSet</a></li>
				
					<li><a href="./OwnedTagSetsController.html">OwnedTagSetsController</a></li>
				
					<li><a href="./PaginationListLinkRenderer.html">PaginationListLinkRenderer</a></li>
				
					<li><a href="./PasswordsController.html">PasswordsController</a></li>
				
					<li><a href="./People.html">People</a></li>
				
					<li><a href="./PeopleController.html">PeopleController</a></li>
				
					<li><a href="./PotentialMatch.html">PotentialMatch</a></li>
				
					<li><a href="./PotentialMatchSettings.html">PotentialMatchSettings</a></li>
				
					<li><a href="./PotentialMatchesController.html">PotentialMatchesController</a></li>
				
					<li><a href="./PotentialPromptMatch.html">PotentialPromptMatch</a></li>
				
					<li><a href="./Preference.html">Preference</a></li>
				
					<li><a href="./PreferencesController.html">PreferencesController</a></li>
				
					<li><a href="./Profile.html">Profile</a></li>
				
					<li><a href="./ProfileController.html">ProfileController</a></li>
				
					<li><a href="./Prompt.html">Prompt</a></li>
				
					<li><a href="./PromptMeme.html">PromptMeme</a></li>
				
					<li><a href="./PromptRestriction.html">PromptRestriction</a></li>
				
					<li><a href="./PromptRestrictionsHelper.html">PromptRestrictionsHelper</a></li>
				
					<li><a href="./PromptsController.html">PromptsController</a></li>
				
					<li><a href="./Pseud.html">Pseud</a></li>
				
					<li><a href="./PseudSweeper.html">PseudSweeper</a></li>
				
					<li><a href="./PseudsController.html">PseudsController</a></li>
				
					<li><a href="./PseudsHelper.html">PseudsHelper</a></li>
				
					<li><a href="./Query.html">Query</a></li>
				
					<li><a href="./Rating.html">Rating</a></li>
				
					<li><a href="./Rawk.html">Rawk</a></li>
				
					<li><a href="./Reading.html">Reading</a></li>
				
					<li><a href="./ReadingsController.html">ReadingsController</a></li>
				
					<li><a href="./RedirectController.html">RedirectController</a></li>
				
					<li><a href="./RedisTestSetup.html">RedisTestSetup</a></li>
				
					<li><a href="./RelatedWork.html">RelatedWork</a></li>
				
					<li><a href="./RelatedWorksController.html">RelatedWorksController</a></li>
				
					<li><a href="./Relationship.html">Relationship</a></li>
				
					<li><a href="./RelationshipNomination.html">RelationshipNomination</a></li>
				
					<li><a href="./Request.html">Request</a></li>
				
					<li><a href="./Role.html">Role</a></li>
				
					<li><a href="./RolesUser.html">RolesUser</a></li>
				
					<li><a href="./SearchController.html">SearchController</a></li>
				
					<li><a href="./SearchHelper.html">SearchHelper</a></li>
				
					<li><a href="./SerialWork.html">SerialWork</a></li>
				
					<li><a href="./SerialWorksController.html">SerialWorksController</a></li>
				
					<li><a href="./Series.html">Series</a></li>
				
					<li><a href="./SeriesController.html">SeriesController</a></li>
				
					<li><a href="./SeriesHelper.html">SeriesHelper</a></li>
				
					<li><a href="./SetTagging.html">SetTagging</a></li>
				
					<li><a href="./Skin.html">Skin</a></li>
				
					<li><a href="./SkinParent.html">SkinParent</a></li>
				
					<li><a href="./SkinsController.html">SkinsController</a></li>
				
					<li><a href="./SkinsHelper.html">SkinsHelper</a></li>
				
					<li><a href="./SortableList.html">SortableList</a></li>
				
					<li><a href="./Stat.html">Stat</a></li>
				
					<li><a href="./StatHash.html">StatHash</a></li>
				
					<li><a href="./StaticSweeper.html">StaticSweeper</a></li>
				
					<li><a href="./StatsController.html">StatsController</a></li>
				
					<li><a href="./StatsHelper.html">StatsHelper</a></li>
				
					<li><a href="./Subscription.html">Subscription</a></li>
				
					<li><a href="./SubscriptionsController.html">SubscriptionsController</a></li>
				
					<li><a href="./Tag.html">Tag</a></li>
				
					<li><a href="./TagNomination.html">TagNomination</a></li>
				
					<li><a href="./TagNominationsController.html">TagNominationsController</a></li>
				
					<li><a href="./TagSet.html">TagSet</a></li>
				
					<li><a href="./TagSetAssociation.html">TagSetAssociation</a></li>
				
					<li><a href="./TagSetAssociationsController.html">TagSetAssociationsController</a></li>
				
					<li><a href="./TagSetNomination.html">TagSetNomination</a></li>
				
					<li><a href="./TagSetNominationsController.html">TagSetNominationsController</a></li>
				
					<li><a href="./TagSetOwnership.html">TagSetOwnership</a></li>
				
					<li><a href="./TagSetSweeper.html">TagSetSweeper</a></li>
				
					<li><a href="./TagSetsHelper.html">TagSetsHelper</a></li>
				
					<li><a href="./TagSweeper.html">TagSweeper</a></li>
				
					<li><a href="./TagWranglersController.html">TagWranglersController</a></li>
				
					<li><a href="./TagWranglingsController.html">TagWranglingsController</a></li>
				
					<li><a href="./Taggable.html">Taggable</a></li>
				
					<li><a href="./Tagging.html">Tagging</a></li>
				
					<li><a href="./TagsController.html">TagsController</a></li>
				
					<li><a href="./TagsHelper.html">TagsHelper</a></li>
				
					<li><a href="./TranslationGenerator.html">TranslationGenerator</a></li>
				
					<li><a href="./TranslationHelper.html">TranslationHelper</a></li>
				
					<li><a href="./TranslationNote.html">TranslationNote</a></li>
				
					<li><a href="./TranslationNotesController.html">TranslationNotesController</a></li>
				
					<li><a href="./TranslationsController.html">TranslationsController</a></li>
				
					<li><a href="./TranslatorsController.html">TranslatorsController</a></li>
				
					<li><a href="./UrlActiveValidator.html">UrlActiveValidator</a></li>
				
					<li><a href="./UrlFormatValidator.html">UrlFormatValidator</a></li>
				
					<li><a href="./UrlHelpers.html">UrlHelpers</a></li>
				
					<li><a href="./User.html">User</a></li>
				
					<li><a href="./UserInviteRequest.html">UserInviteRequest</a></li>
				
					<li><a href="./UserInviteRequestsController.html">UserInviteRequestsController</a></li>
				
					<li><a href="./UserInviteRequestsHelper.html">UserInviteRequestsHelper</a></li>
				
					<li><a href="./UserMailer.html">UserMailer</a></li>
				
					<li><a href="./UserSession.html">UserSession</a></li>
				
					<li><a href="./UserSessionsController.html">UserSessionsController</a></li>
				
					<li><a href="./UsersController.html">UsersController</a></li>
				
					<li><a href="./UsersHelper.html">UsersHelper</a></li>
				
					<li><a href="./ValidationHelper.html">ValidationHelper</a></li>
				
					<li><a href="./Warning.html">Warning</a></li>
				
					<li><a href="./WeightedRandom.html">WeightedRandom</a></li>
				
					<li><a href="./Work.html">Work</a></li>
				
					<li><a href="./WorkObserver.html">WorkObserver</a></li>
				
					<li><a href="./WorkSkin.html">WorkSkin</a></li>
				
					<li><a href="./WorkSweeper.html">WorkSweeper</a></li>
				
					<li><a href="./WorksController.html">WorksController</a></li>
				
					<li><a href="./WorksHelper.html">WorksHelper</a></li>
				
					<li><a href="./WranglingAssignment.html">WranglingAssignment</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">UsersController</h1>

		<div id="description">
			
		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="activate-method" class="method-detail ">
				<a name="method-i-activate"></a>

				<div class="method-heading">
				
					<span class="method-name">activate</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="activate-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 223</span>
223:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">activate</span>
224:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>].<span class="ruby-identifier">blank?</span>
225:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your activation key is missing.&quot;</span>)
226:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-value str">''</span>
227:     <span class="ruby-keyword kw">else</span>
228:       <span class="ruby-ivar">@user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_activation_code</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
229:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>
230:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">active?</span>
231:           <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>].<span class="ruby-identifier">now</span> = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your account has already been activated.&quot;</span>)
232:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@user</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
233:         <span class="ruby-keyword kw">end</span>
234:         <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">activate</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">UserMailer</span>.<span class="ruby-identifier">activation</span>(<span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">deliver</span>
235:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Signup complete! Please log in.&quot;</span>)
236:         <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">create_log_item</span>( <span class="ruby-identifier">options</span> = {<span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">ACTION_ACTIVATE</span>})
237:         <span class="ruby-comment cmt"># assign over any external authors that belong to this user</span>
238:         <span class="ruby-identifier">external_authors</span> = []
239:         <span class="ruby-identifier">external_authors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">ExternalAuthor</span>.<span class="ruby-identifier">find_by_email</span>(<span class="ruby-ivar">@user</span>.<span class="ruby-identifier">email</span>)
240:         <span class="ruby-ivar">@invitation</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">invitation</span>
241:         <span class="ruby-identifier">external_authors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@invitation</span>.<span class="ruby-identifier">external_author</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@invitation</span>
242:         <span class="ruby-identifier">external_authors</span>.<span class="ruby-identifier">compact!</span>
243:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">external_authors</span>.<span class="ruby-identifier">empty?</span>
244:           <span class="ruby-identifier">external_authors</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">external_author</span><span class="ruby-operator">|</span>
245:             <span class="ruby-identifier">external_author</span>.<span class="ruby-identifier">claim!</span>(<span class="ruby-ivar">@user</span>)
246:           <span class="ruby-keyword kw">end</span>
247:           <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot; We found some works already uploaded to the Archive of Our Own that we think belong to you! You'll see them on your homepage when you've logged in.&quot;</span>)
248:         <span class="ruby-keyword kw">end</span>
249:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">identity_url</span>
250:           <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">login_path</span>(<span class="ruby-value">:use_openid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
251:         <span class="ruby-keyword kw">else</span>
252:           <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">login_path</span>)
253:         <span class="ruby-keyword kw">end</span>
254:       <span class="ruby-keyword kw">else</span>
255:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your activation key is invalid. If you didn't activate within 14 days, your account was deleted. Please sign up again, or contact support via the link in our footer for more help.&quot;</span>).<span class="ruby-identifier">html_safe</span>
256:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-value str">''</span>
257:       <span class="ruby-keyword kw">end</span>
258:     <span class="ruby-keyword kw">end</span>
259:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="browse-method" class="method-detail ">
				<a name="method-i-browse"></a>

				<div class="method-heading">
				
					<span class="method-name">browse</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="browse-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 403</span>
403:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">browse</span>
404:     <span class="ruby-ivar">@co_authors</span> = <span class="ruby-constant">Pseud</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:name</span>).<span class="ruby-identifier">coauthor_of</span>(<span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>)
405:     <span class="ruby-ivar">@tag_types</span> = <span class="ruby-node">%(Fandom Character Relationship Freeform)</span>
406:     <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">with_scoped_count</span>.<span class="ruby-identifier">includes</span>(<span class="ruby-value">:merger</span>)
407:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;count&quot;</span>
408:       <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tags</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;count DESC&quot;</span>)
409:     <span class="ruby-keyword kw">else</span>
410:       <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tags</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;name ASC&quot;</span>)
411:     <span class="ruby-keyword kw">end</span>
412:     <span class="ruby-ivar">@tags</span> = <span class="ruby-ivar">@tags</span>.<span class="ruby-identifier">group_by</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>}
413:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="change-email-method" class="method-detail ">
				<a name="method-i-change_email"></a>

				<div class="method-heading">
				
					<span class="method-name">change_email</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="change-email-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 273</span>
273:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_email</span>
274:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:new_email</span>].<span class="ruby-identifier">blank?</span>
275:       <span class="ruby-identifier">render</span> <span class="ruby-value">:change_email</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
276:     <span class="ruby-keyword kw">else</span>
277:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reauthenticate</span>
278:         <span class="ruby-identifier">render</span> <span class="ruby-value">:change_email</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
279:       <span class="ruby-keyword kw">else</span>
280:     <span class="ruby-ivar">@old_email</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">email</span>
281:     <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:new_email</span>]
282:     <span class="ruby-ivar">@new_email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:new_email</span>]
283:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">save</span>
284:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your email has been successfully updated&quot;</span>)
285:       <span class="ruby-constant">UserMailer</span>.<span class="ruby-identifier">change_email</span>(<span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>, <span class="ruby-ivar">@old_email</span>, <span class="ruby-ivar">@new_email</span>).<span class="ruby-identifier">deliver</span>
286:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">create_log_item</span>( <span class="ruby-identifier">options</span> = {<span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">ACTION_NEW_EMAIL</span>})
287:     <span class="ruby-keyword kw">else</span>
288:       <span class="ruby-identifier">render</span> <span class="ruby-value">:change_email</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
289:     <span class="ruby-keyword kw">end</span>
290:     <span class="ruby-keyword kw">end</span>
291:     <span class="ruby-keyword kw">end</span>
292:   <span class="ruby-identifier">render</span> <span class="ruby-value">:change_email</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
293:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="change-openid-method" class="method-detail ">
				<a name="method-i-change_openid"></a>

				<div class="method-heading">
				
					<span class="method-name">change_openid</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="change-openid-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_openid</span>
125:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:identity_url</span>]
126:       <span class="ruby-ivar">@openid_url</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:identity_url</span>]
127:       <span class="ruby-ivar">@openid_url</span> = <span class="ruby-node">&quot;http://#{@openid_url}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@openid_url</span>.<span class="ruby-identifier">match</span>(<span class="ruby-value str">&quot;http://&quot;</span>)
128:       <span class="ruby-ivar">@openid_url</span> = <span class="ruby-constant">OpenID</span>.<span class="ruby-identifier">normalize_url</span>(<span class="ruby-ivar">@openid_url</span>)
129:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">reauthenticate</span>
130:         <span class="ruby-identifier">render</span> <span class="ruby-value">:change_openid</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
131:       <span class="ruby-keyword kw">end</span>
132:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">identity_url</span> = <span class="ruby-ivar">@openid_url</span>
133:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">recently_reset</span> = <span class="ruby-keyword kw">false</span>
134:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">save</span>
135:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">'Your OpenID URL has been successfully updated.'</span>)
136:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">user_profile_path</span>(<span class="ruby-ivar">@user</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
137:       <span class="ruby-keyword kw">else</span>
138:         <span class="ruby-identifier">render</span> <span class="ruby-value">:change_password</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
139:       <span class="ruby-keyword kw">end</span>
140:     <span class="ruby-keyword kw">end</span>
141:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="change-password-method" class="method-detail ">
				<a name="method-i-change_password"></a>

				<div class="method-heading">
				
					<span class="method-name">change_password</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="change-password-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 105</span>
105:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_password</span>
106:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:password</span>]
107:       <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">recently_reset?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">reauthenticate</span>
108:         <span class="ruby-identifier">render</span> <span class="ruby-value">:change_password</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
109:       <span class="ruby-keyword kw">end</span>
110:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">password</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:password</span>]
111:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">password_confirmation</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:password_confirmation</span>]
112:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">recently_reset</span> = <span class="ruby-keyword kw">false</span>
113:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">save</span>
114:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your password has been changed&quot;</span>)
115:         <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">create_log_item</span>( <span class="ruby-identifier">options</span> = {<span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">ACTION_PASSWORD_RESET</span>})
116:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">user_profile_path</span>(<span class="ruby-ivar">@user</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
117:       <span class="ruby-keyword kw">else</span>
118:         <span class="ruby-identifier">render</span> <span class="ruby-value">:change_password</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
119:       <span class="ruby-keyword kw">end</span>
120:     <span class="ruby-keyword kw">end</span>
121:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="change-username-method" class="method-detail ">
				<a name="method-i-change_username"></a>

				<div class="method-heading">
				
					<span class="method-name">change_username</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="change-username-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_username</span>
144:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:new_login</span>]
145:       <span class="ruby-ivar">@new_login</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:new_login</span>]
146:       <span class="ruby-identifier">session</span> = <span class="ruby-constant">UserSession</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:login</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">login</span>, <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:password</span>])
147:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">session</span>.<span class="ruby-identifier">valid?</span>
148:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your password was incorrect&quot;</span>)
149:       <span class="ruby-keyword kw">else</span>
150:         <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_login</span>(<span class="ruby-ivar">@new_login</span>)
151:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">user</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@user</span>)
152:           <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;User name already taken.&quot;</span>)
153:         <span class="ruby-keyword kw">else</span>
154:           <span class="ruby-identifier">old_login</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">login</span>
155:           <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">login</span> = <span class="ruby-ivar">@new_login</span>
156:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">save</span>
157:             <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your user name was changed&quot;</span>)
158: 
159:             <span class="ruby-identifier">new_pseud</span> = <span class="ruby-constant">Pseud</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@new_login</span>, <span class="ruby-value">:user_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">first</span>
160:             <span class="ruby-identifier">old_pseud</span> = <span class="ruby-constant">Pseud</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">old_login</span>, <span class="ruby-value">:user_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">first</span>
161:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_pseud</span>
162:               <span class="ruby-comment cmt"># do nothing - they already have the matching pseud</span>
163:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">old_pseud</span>
164:               <span class="ruby-comment cmt"># change the old pseud to match</span>
165:               <span class="ruby-identifier">old_pseud</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:name</span>, <span class="ruby-ivar">@new_login</span>)
166:             <span class="ruby-keyword kw">else</span>
167:               <span class="ruby-comment cmt"># shouldn't be able to get here, but just in case</span>
168:               <span class="ruby-constant">Pseud</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@new_login</span>, <span class="ruby-value">:user_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>)
169:             <span class="ruby-keyword kw">end</span>
170: 
171:             <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@user</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
172:           <span class="ruby-keyword kw">else</span>
173:             <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">clear</span>
174:             <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">reload</span>
175:             <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;User name must begin and end with a letter or number; it may also contain underscores but no other characters.&quot;</span>)
176:           <span class="ruby-keyword kw">end</span>
177:         <span class="ruby-keyword kw">end</span>
178:       <span class="ruby-keyword kw">end</span>
179:     <span class="ruby-keyword kw">end</span>
180:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="check-account-creation-status-method" class="method-detail ">
				<a name="method-i-check_account_creation_status"></a>

				<div class="method-heading">
				
					<span class="method-name">check_account_creation_status</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="check-account-creation-status-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 14</span>
14:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_account_creation_status</span>
15:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_registered_user?</span>
16:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;You are already logged in!&quot;</span>)
17:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">root_path</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
18:     <span class="ruby-keyword kw">end</span>
19:     <span class="ruby-identifier">token</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:invitation_token</span>]
20:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">blank?</span>
21:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@admin_settings</span>.<span class="ruby-identifier">account_creation_enabled?</span>
22:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;You need an invitation to sign up.&quot;</span>)
23:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">invite_requests_path</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
24:       <span class="ruby-keyword kw">end</span>
25:     <span class="ruby-keyword kw">else</span>
26:       <span class="ruby-identifier">invitation</span> = <span class="ruby-constant">Invitation</span>.<span class="ruby-identifier">find_by_token</span>(<span class="ruby-identifier">token</span>)
27:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">invitation</span>
28:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;There was an error with your invitation token, please contact support&quot;</span>)
29:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">new_feedback_report_path</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
30:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">invitation</span>.<span class="ruby-identifier">redeemed_at</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">invitation</span>.<span class="ruby-identifier">invitee</span>
31:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;This invitation has already been used to create an account, sorry!&quot;</span>)
32:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">root_path</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
33:       <span class="ruby-keyword kw">end</span>
34:     <span class="ruby-keyword kw">end</span>
35:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="create-method" class="method-detail ">
				<a name="method-i-create"></a>

				<div class="method-heading">
				
					<span class="method-name">create</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
POST /users POST /users.xml
</p>
					

					
					<div class="method-source-code"
						id="create-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 184</span>
184:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>
185:     <span class="ruby-ivar">@hide_dashboard</span> = <span class="ruby-keyword kw">true</span>
186:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:cancel_create_account</span>]
187:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">root_path</span>
188:     <span class="ruby-keyword kw">else</span>
189:       <span class="ruby-ivar">@user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>
190:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">login</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:login</span>]
191:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:email</span>]
192:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">invitation_token</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:invitation_token</span>]
193:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">age_over_13</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:age_over_13</span>]
194:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">terms_of_service</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:terms_of_service</span>]
195:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">password</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:password</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:password</span>]
196:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">password_confirmation</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:password_confirmation</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:password_confirmation</span>]
197:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">activation_code</span> = <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>.<span class="ruby-identifier">hexdigest</span>( <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">//</span>).<span class="ruby-identifier">sort_by</span> {<span class="ruby-identifier">rand</span>}.<span class="ruby-identifier">join</span> )
198:       <span class="ruby-identifier">openid_url</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:identity_url</span>]
199:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">openid_url</span>.<span class="ruby-identifier">blank?</span>
200:         <span class="ruby-comment cmt"># normalize OpenID url before saving</span>
201:         <span class="ruby-comment cmt"># TODO validate openid before creating account</span>
202:         <span class="ruby-identifier">openid_url</span> = <span class="ruby-node">&quot;http://#{openid_url}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">openid_url</span>.<span class="ruby-identifier">match</span>(<span class="ruby-value str">&quot;http://&quot;</span>)
203:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_identity_url</span>(<span class="ruby-identifier">openid_url</span>)
204:           <span class="ruby-identifier">params</span>[<span class="ruby-value">:use_openid</span>] = <span class="ruby-keyword kw">true</span>
205:           <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value">:error</span>] = <span class="ruby-value str">&quot;OpenID url is already being used&quot;</span>
206:           <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
207:         <span class="ruby-keyword kw">else</span>
208:           <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">identity_url</span> = <span class="ruby-constant">OpenID</span>.<span class="ruby-identifier">normalize_url</span>(<span class="ruby-identifier">openid_url</span>)
209:         <span class="ruby-keyword kw">end</span>
210:       <span class="ruby-keyword kw">end</span>
211:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">save</span>
212:         <span class="ruby-constant">UserMailer</span>.<span class="ruby-identifier">signup_notification</span>(<span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">deliver</span>
213:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;During testing you can activate via &lt;a href='%{activation_url}'&gt;your activation url&lt;/a&gt;.&quot;</span>,
214:                             <span class="ruby-value">:activation_url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">activate_path</span>(<span class="ruby-ivar">@user</span>.<span class="ruby-identifier">activation_code</span>)) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Rails</span>.<span class="ruby-identifier">env</span>.<span class="ruby-identifier">development?</span>
215:         <span class="ruby-identifier">render</span> <span class="ruby-value str">&quot;confirmation&quot;</span>
216:       <span class="ruby-keyword kw">else</span>
217:         <span class="ruby-identifier">params</span>[<span class="ruby-value">:use_openid</span>] = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">openid_url</span>.<span class="ruby-identifier">blank?</span>
218:         <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new&quot;</span>
219:       <span class="ruby-keyword kw">end</span>
220:     <span class="ruby-keyword kw">end</span>
221:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="delete-confirmation-method" class="method-detail ">
				<a name="method-i-delete_confirmation"></a>

				<div class="method-heading">
				
					<span class="method-name">delete_confirmation</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="delete-confirmation-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 384</span>
384:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_confirmation</span>
385:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="destroy-method" class="method-detail ">
				<a name="method-i-destroy"></a>

				<div class="method-heading">
				
					<span class="method-name">destroy</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
DELETE /users/1 DELETE /users/1.xml
</p>
					

					
					<div class="method-source-code"
						id="destroy-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 297</span>
297:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy</span>
298:     <span class="ruby-ivar">@hide_dashboard</span> = <span class="ruby-keyword kw">true</span>
299:     <span class="ruby-ivar">@works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:posted</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>})
300:     <span class="ruby-ivar">@sole_owned_collections</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">collections</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">collection</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">collection</span>.<span class="ruby-identifier">all_owners</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>).<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>}
301:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@works</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@sole_owned_collections</span>.<span class="ruby-identifier">empty?</span>
302:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">unposted_works</span>
303:         <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">wipeout_unposted_works</span>
304:       <span class="ruby-keyword kw">end</span>
305:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">destroy</span>
306:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">'You have successfully deleted your account.'</span>)
307:      <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">delete_confirmation_path</span>)
308:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:coauthor</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sole_author</span>].<span class="ruby-identifier">blank?</span>
309:       <span class="ruby-ivar">@sole_authored_works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">sole_authored_works</span>
310:       <span class="ruby-ivar">@coauthored_works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">coauthored_works</span>
311:       <span class="ruby-identifier">render</span> <span class="ruby-value str">'delete_preview'</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
312:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:coauthor</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sole_author</span>]
313:       <span class="ruby-ivar">@sole_authored_works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">sole_authored_works</span>
314:       <span class="ruby-ivar">@coauthored_works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">coauthored_works</span>
315:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:cancel_button</span>]
316:         <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Account deletion canceled.&quot;</span>)
317:        <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">user_profile_path</span>(<span class="ruby-ivar">@user</span>)
318:       <span class="ruby-keyword kw">else</span>
319:         <span class="ruby-comment cmt"># Orphans co-authored works, keeps the user's pseud on the orphan account</span>
320:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:coauthor</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'keep_pseud'</span>
321:           <span class="ruby-identifier">pseuds</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>
322:           <span class="ruby-identifier">works</span> = <span class="ruby-ivar">@coauthored_works</span>
323:           <span class="ruby-identifier">use_default</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:use_default</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;true&quot;</span>
324:           <span class="ruby-constant">Creatorship</span>.<span class="ruby-identifier">orphan</span>(<span class="ruby-identifier">pseuds</span>, <span class="ruby-identifier">works</span>, <span class="ruby-identifier">use_default</span>)
325:           <span class="ruby-comment cmt"># Orphans co-authored works, changes pseud to the default orphan pseud</span>
326:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:coauthor</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'orphan_pseud'</span>
327:           <span class="ruby-identifier">pseuds</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>
328:           <span class="ruby-identifier">works</span> = <span class="ruby-ivar">@coauthored_works</span>
329:           <span class="ruby-constant">Creatorship</span>.<span class="ruby-identifier">orphan</span>(<span class="ruby-identifier">pseuds</span>, <span class="ruby-identifier">works</span>)
330:           <span class="ruby-comment cmt"># Removes user as an author from co-authored works</span>
331:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:coauthor</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'remove'</span>
332:           <span class="ruby-ivar">@coauthored_works</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">w</span><span class="ruby-operator">|</span>
333:             <span class="ruby-identifier">pseuds_with_author_removed</span> = <span class="ruby-identifier">w</span>.<span class="ruby-identifier">pseuds</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>
334:             <span class="ruby-identifier">w</span>.<span class="ruby-identifier">pseuds</span> = <span class="ruby-identifier">pseuds_with_author_removed</span>
335:             <span class="ruby-identifier">w</span>.<span class="ruby-identifier">save</span>
336:             <span class="ruby-identifier">w</span>.<span class="ruby-identifier">chapters</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
337:               <span class="ruby-identifier">c</span>.<span class="ruby-identifier">pseuds</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">pseuds</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>
338:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">pseuds</span>.<span class="ruby-identifier">empty?</span>
339:                 <span class="ruby-identifier">c</span>.<span class="ruby-identifier">pseuds</span> = <span class="ruby-identifier">w</span>.<span class="ruby-identifier">pseuds</span>
340:               <span class="ruby-keyword kw">end</span>
341:               <span class="ruby-identifier">c</span>.<span class="ruby-identifier">save</span>
342:             <span class="ruby-keyword kw">end</span>
343:           <span class="ruby-keyword kw">end</span>
344:         <span class="ruby-keyword kw">end</span>
345:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sole_author</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'keep_pseud'</span>
346:           <span class="ruby-comment cmt"># Orphans works where user is sole author, keeps their pseud on the orphan account</span>
347:           <span class="ruby-identifier">pseuds</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>
348:           <span class="ruby-identifier">works</span> = <span class="ruby-ivar">@sole_authored_works</span>
349:           <span class="ruby-identifier">use_default</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:use_default</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;true&quot;</span>
350:           <span class="ruby-constant">Creatorship</span>.<span class="ruby-identifier">orphan</span>(<span class="ruby-identifier">pseuds</span>, <span class="ruby-identifier">works</span>, <span class="ruby-identifier">use_default</span>)
351:           <span class="ruby-constant">Collection</span>.<span class="ruby-identifier">orphan</span>(<span class="ruby-identifier">pseuds</span>, <span class="ruby-ivar">@sole_owned_collections</span>, <span class="ruby-identifier">use_default</span>)
352:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sole_author</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'orphan_pseud'</span>
353:           <span class="ruby-comment cmt"># Orphans works where user is sole author, uses the default orphan pseud</span>
354:           <span class="ruby-identifier">pseuds</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">pseuds</span>
355:           <span class="ruby-identifier">works</span> = <span class="ruby-ivar">@sole_authored_works</span>
356:           <span class="ruby-constant">Creatorship</span>.<span class="ruby-identifier">orphan</span>(<span class="ruby-identifier">pseuds</span>, <span class="ruby-identifier">works</span>)
357:           <span class="ruby-constant">Collection</span>.<span class="ruby-identifier">orphan</span>(<span class="ruby-identifier">pseuds</span>, <span class="ruby-ivar">@sole_owned_collections</span>)
358:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:sole_author</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'delete'</span>
359:           <span class="ruby-comment cmt"># Deletes works where user is sole author</span>
360:           <span class="ruby-ivar">@sole_authored_works</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
361:             <span class="ruby-identifier">s</span>.<span class="ruby-identifier">destroy</span>
362:           <span class="ruby-keyword kw">end</span>
363:           <span class="ruby-comment cmt"># Deletes collections where user is sole author</span>
364:           <span class="ruby-ivar">@sole_owned_collections</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
365:             <span class="ruby-identifier">c</span>.<span class="ruby-identifier">destroy</span>
366:           <span class="ruby-keyword kw">end</span>
367:         <span class="ruby-keyword kw">end</span>
368:         <span class="ruby-ivar">@works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:posted</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>})
369:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@works</span>.<span class="ruby-identifier">blank?</span>
370:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">unposted_works</span>
371:             <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">wipeout_unposted_works</span>
372:           <span class="ruby-keyword kw">end</span>
373:           <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">destroy</span>
374:           <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">'You have successfully deleted your account.'</span>)
375:           <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">delete_confirmation_path</span>)
376:         <span class="ruby-keyword kw">else</span>
377:           <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Sorry, something went wrong! Please try again.&quot;</span>)
378:           <span class="ruby-identifier">redirect_to</span>(<span class="ruby-ivar">@user</span>)
379:         <span class="ruby-keyword kw">end</span>
380:       <span class="ruby-keyword kw">end</span>
381:     <span class="ruby-keyword kw">end</span>
382:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="edit-method" class="method-detail ">
				<a name="method-i-edit"></a>

				<div class="method-heading">
				
					<span class="method-name">edit</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
GET /users/1/edit
</p>
					

					
					<div class="method-source-code"
						id="edit-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 102</span>
102:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">edit</span>
103:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="end-banner-method" class="method-detail ">
				<a name="method-i-end_banner"></a>

				<div class="method-heading">
				
					<span class="method-name">end_banner</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="end-banner-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 395</span>
395:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">end_banner</span>
396:     <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">preference</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:banner_seen</span>, <span class="ruby-keyword kw">true</span>)
397:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
398:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">&quot;HTTP_REFERER&quot;</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">root_path</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span> }
399:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">js</span>
400:     <span class="ruby-keyword kw">end</span>
401:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="end-first-login-method" class="method-detail ">
				<a name="method-i-end_first_login"></a>

				<div class="method-heading">
				
					<span class="method-name">end_first_login</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="end-first-login-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 387</span>
387:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">end_first_login</span>
388:     <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">preference</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:first_login</span>, <span class="ruby-keyword kw">false</span>)
389:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
390:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@user</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span> }
391:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">js</span>
392:     <span class="ruby-keyword kw">end</span>
393:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="index-method" class="method-detail ">
				<a name="method-i-index"></a>

				<div class="method-heading">
				
					<span class="method-name">index</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="index-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 37</span>
37:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
38:     <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">keep</span>
39:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:people</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:index</span>
40:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="load-user-method" class="method-detail ">
				<a name="method-i-load_user"></a>

				<div class="method-heading">
				
					<span class="method-name">load_user</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="load-user-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 9</span>
 9:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_user</span>
10:     <span class="ruby-ivar">@user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_login</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
11:     <span class="ruby-ivar">@check_ownership_of</span> = <span class="ruby-ivar">@user</span>
12:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="new-method" class="method-detail ">
				<a name="method-i-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
GET /users/new GET /users/new.xml
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 91</span>
91:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new</span>
92:     <span class="ruby-ivar">@user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>
93:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:invitation_token</span>]
94:       <span class="ruby-ivar">@invitation</span> = <span class="ruby-constant">Invitation</span>.<span class="ruby-identifier">find_by_token</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:invitation_token</span>])
95:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">invitation_token</span> = <span class="ruby-ivar">@invitation</span>.<span class="ruby-identifier">token</span>
96:       <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">email</span> = <span class="ruby-ivar">@invitation</span>.<span class="ruby-identifier">invitee_email</span>
97:     <span class="ruby-keyword kw">end</span>
98:     <span class="ruby-ivar">@hide_dashboard</span> = <span class="ruby-keyword kw">true</span>
99:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="show-method" class="method-detail ">
				<a name="method-i-show"></a>

				<div class="method-heading">
				
					<span class="method-name">show</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
GET /users/1
</p>
					

					
					<div class="method-source-code"
						id="show-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 43</span>
43:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show</span>
44:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">blank?</span>
45:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Sorry, could not find this user.&quot;</span>)
46:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">people_path</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
47:     <span class="ruby-keyword kw">end</span>
48: 
49:     <span class="ruby-comment cmt"># very similar to show under pseuds - if you change something here, change it there too</span>
50:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">nil?</span>
51:       <span class="ruby-comment cmt"># hahaha omg so ugly BUT IT WORKS :P</span>
52:       <span class="ruby-ivar">@fandoms</span> = <span class="ruby-constant">Fandom</span>.<span class="ruby-identifier">select</span>(<span class="ruby-value str">&quot;tags.*, count(tags.id) as work_count&quot;</span>).
53:                    <span class="ruby-identifier">joins</span>(<span class="ruby-value">:direct_filter_taggings</span>).
54:                    <span class="ruby-identifier">joins</span>(<span class="ruby-value str">&quot;INNER JOIN works ON filter_taggings.filterable_id = works.id AND filter_taggings.filterable_type = 'Work'&quot;</span>).
55:                    <span class="ruby-identifier">group</span>(<span class="ruby-value str">&quot;tags.id&quot;</span>).<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;work_count DESC&quot;</span>) &amp;
56:                    <span class="ruby-constant">Work</span>.<span class="ruby-identifier">visible_to_all</span>.<span class="ruby-identifier">revealed</span> &amp;
57:                    <span class="ruby-constant">Work</span>.<span class="ruby-identifier">joins</span>(<span class="ruby-value str">&quot;INNER JOIN creatorships ON creatorships.creation_id = works.id AND creatorships.creation_type = 'Work'
58:     INNER JOIN pseuds ON creatorships.pseud_id = pseuds.id
59:     INNER JOIN users ON pseuds.user_id = users.id&quot;</span>).<span class="ruby-identifier">where</span>(<span class="ruby-value str">&quot;users.id = ?&quot;</span>, <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>)
60:       <span class="ruby-identifier">visible_works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible_to_all</span>
61:       <span class="ruby-identifier">visible_series</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">series</span>.<span class="ruby-identifier">visible_to_all</span>
62:       <span class="ruby-identifier">visible_bookmarks</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">bookmarks</span>.<span class="ruby-identifier">visible_to_all</span>
63:     <span class="ruby-keyword kw">else</span>
64:       <span class="ruby-ivar">@fandoms</span> = <span class="ruby-constant">Fandom</span>.<span class="ruby-identifier">select</span>(<span class="ruby-value str">&quot;tags.*, count(tags.id) as work_count&quot;</span>).
65:                    <span class="ruby-identifier">joins</span>(<span class="ruby-value">:direct_filter_taggings</span>).
66:                    <span class="ruby-identifier">joins</span>(<span class="ruby-value str">&quot;INNER JOIN works ON filter_taggings.filterable_id = works.id AND filter_taggings.filterable_type = 'Work'&quot;</span>).
67:                    <span class="ruby-identifier">group</span>(<span class="ruby-value str">&quot;tags.id&quot;</span>).<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;work_count DESC&quot;</span>) &amp;
68:                    <span class="ruby-constant">Work</span>.<span class="ruby-identifier">visible_to_registered_user</span>.<span class="ruby-identifier">revealed</span> &amp;
69:                    <span class="ruby-constant">Work</span>.<span class="ruby-identifier">joins</span>(<span class="ruby-value str">&quot;INNER JOIN creatorships ON creatorships.creation_id = works.id AND creatorships.creation_type = 'Work'
70:     INNER JOIN pseuds ON creatorships.pseud_id = pseuds.id
71:     INNER JOIN users ON pseuds.user_id = users.id&quot;</span>).<span class="ruby-identifier">where</span>(<span class="ruby-value str">&quot;users.id = ?&quot;</span>, <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>)
72:       <span class="ruby-identifier">visible_works</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">works</span>.<span class="ruby-identifier">visible_to_registered_user</span>
73:       <span class="ruby-identifier">visible_series</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">series</span>.<span class="ruby-identifier">visible_to_registered_user</span>
74:       <span class="ruby-identifier">visible_bookmarks</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">bookmarks</span>.<span class="ruby-identifier">visible_to_registered_user</span>
75:     <span class="ruby-keyword kw">end</span>
76: 
77:     <span class="ruby-ivar">@fandoms</span> = <span class="ruby-ivar">@fandoms</span>.<span class="ruby-identifier">all</span> <span class="ruby-comment cmt"># force eager loading</span>
78:     <span class="ruby-ivar">@works</span> = <span class="ruby-identifier">visible_works</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;revised_at DESC&quot;</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">NUMBER_OF_ITEMS_VISIBLE_IN_DASHBOARD</span>)
79:     <span class="ruby-ivar">@series</span> = <span class="ruby-identifier">visible_series</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;updated_at DESC&quot;</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">NUMBER_OF_ITEMS_VISIBLE_IN_DASHBOARD</span>)
80:     <span class="ruby-ivar">@bookmarks</span> = <span class="ruby-identifier">visible_bookmarks</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value str">&quot;updated_at DESC&quot;</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-constant">ArchiveConfig</span>.<span class="ruby-constant">NUMBER_OF_ITEMS_VISIBLE_IN_DASHBOARD</span>)
81: 
82:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:subscriptions</span>)
83:       <span class="ruby-ivar">@subscription</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">subscriptions</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:subscribable_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">id</span>,
84:                                                        <span class="ruby-value">:subscribable_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'User'</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">||</span>
85:                       <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">subscriptions</span>.<span class="ruby-identifier">build</span>
86:     <span class="ruby-keyword kw">end</span>
87:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="update-method" class="method-detail ">
				<a name="method-i-update"></a>

				<div class="method-heading">
				
					<span class="method-name">update</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
PUT /users/1 PUT /users/1.xml
</p>
					

					
					<div class="method-source-code"
						id="update-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 263</span>
263:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>
264:     <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">profile</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:profile_attributes</span>])
265:   <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">profile</span>.<span class="ruby-identifier">save</span>
266:     <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your profile has been successfully updated&quot;</span>)
267:     <span class="ruby-identifier">render</span> <span class="ruby-value">:edit</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
268:   <span class="ruby-keyword kw">else</span>
269:     <span class="ruby-identifier">render</span> <span class="ruby-value">:edit</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span>
270:   <span class="ruby-keyword kw">end</span>
271:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="private-instance-method-details" class="method-section section">
			<h3 class="section-header">Private Instance Methods</h3>

		
			<div id="reauthenticate-method" class="method-detail ">
				<a name="method-i-reauthenticate"></a>

				<div class="method-heading">
				
					<span class="method-name">reauthenticate</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="reauthenticate-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/users_controller.rb, line 417</span>
417:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reauthenticate</span>
418:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">params</span>[<span class="ruby-value">:password_check</span>].<span class="ruby-identifier">blank?</span>
419:       <span class="ruby-identifier">session</span> = <span class="ruby-constant">UserSession</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:login</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">login</span>, <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:password_check</span>])
420:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">valid?</span>
421:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
422:       <span class="ruby-keyword kw">else</span>
423:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:new_email</span>]
424:           <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your password was incorrect&quot;</span>)
425:         <span class="ruby-keyword kw">else</span>
426:           <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;Your old password was incorrect&quot;</span>)
427:         <span class="ruby-keyword kw">end</span>
428:         <span class="ruby-ivar">@wrong_password</span> = <span class="ruby-keyword kw">true</span>
429:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
430:       <span class="ruby-keyword kw">end</span>
431:     <span class="ruby-keyword kw">else</span>
432:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:new_email</span>]
433:         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;You must enter your password&quot;</span>)
434:       <span class="ruby-keyword kw">else</span>
435:         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value">:error</span>] = <span class="ruby-identifier">ts</span>(<span class="ruby-value str">&quot;You must enter your old password&quot;</span>)
436:       <span class="ruby-keyword kw">end</span>
437:       <span class="ruby-ivar">@wrong_password</span> = <span class="ruby-keyword kw">true</span>
438:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
439:     <span class="ruby-keyword kw">end</span>
440:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

